window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();
(function(){var a=false,b=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.PClass=function(){};PClass.extend=function(e){function g(){!a&&this.init&&this.init.apply(this,arguments)}var f=this.prototype;a=true;var i=new this;a=false;for(var h in e)i[h]=typeof e[h]=="function"&&typeof f[h]=="function"&&b.test(e[h])?function(a,b){return function(){var e=this._super;this._super=f[a];var g=b.apply(this,arguments);this._super=e;return g}}(h,e[h]):e[h];g.prototype=i;g.prototype.constructor=g;g.extend=arguments.callee;
return g}})();
typeof pulse=="undefined"&&(pulse={events:{mousedown:"mouse",mouseup:"mouse",mouseover:"mouse",mouseout:"mouse",click:"mouse",mousemove:"mouse",mousewheel:"mouse",keyup:"keyboard",keydown:"keyboard",keypress:"keyboard",touchstart:"touch",touchmove:"touch",touchend:"touch",touchcancel:"touch",touchclick:"touch",gesturestart:"touchgesture",gesturechange:"touchgesture",gestureend:"touchgesture"},eventtranslations:{touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"},customevents:{dragstart:"drag",dragdrop:"drag",
dragenter:"drag",dragover:"drag",dragexit:"drag",complete:"action",finished:"audio"}});var pulse=pulse||{};pulse.readyCallbacks=[];pulse.isReady=false;pulse.ready=function(a){if(document.readyState==="complete")pulse.isReady=true;pulse.isReady&&setTimeout(a,1);pulse.readyCallbacks.push(a)};pulse.DOMContentLoaded=function(){if(!pulse.isReady){pulse.isReady=true;for(var a in pulse.readyCallbacks)pulse.readyCallbacks[a]()}};
document.readyState!=="complete"&&(document.addEventListener?(document.addEventListener("DOMContentLoaded",pulse.DOMContentLoaded,false),window.addEventListener("load",pulse.DOMContentLoaded,false)):document.attachEvent&&(document.attachEvent("onreadystatechange",pulse.DOMContentLoaded),window.attachEvent("onload",pulse.DOMContentLoaded)));pulse.DEBUG=false;/*


 SoundManager 2: JavaScript Sound for the Web
 ----------------------------------------------
 http://schillmania.com/projects/soundmanager2/

 Copyright (c) 2007, Scott Schiller. All rights reserved.
 Code provided under the BSD License:
 http://schillmania.com/projects/soundmanager2/license.txt

 V2.97a.20111030
*/
(function(a){a.SoundManager=function(b,e){function g(a){return function(c){return!this._t||!this._t._a?null:a.call(this,c)}}this.flashVersion=8;this.debugFlash=this.debugMode=false;this.useConsole=true;this.waitForWindowLoad=this.consoleOnly=false;this.bgColor="#ffffff";this.useHighPerformance=false;this.flashPollingInterval=null;this.flashLoadTimeout=1E3;this.wmode=null;this.allowScriptAccess="always";this.useFlashBlock=false;this.useHTML5Audio=true;this.html5Test=/^(probably|maybe)$/i;this.preferFlash=
true;this.noSWFCache=false;this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:true},mp4:{related:["aac","m4a"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:false},ogg:{type:["audio/ogg; codecs=vorbis"],required:false},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:false}};this.defaultOptions={autoLoad:false,stream:true,autoPlay:false,
loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onstop:null,onfailure:null,onfinish:null,multiShot:true,multiShotEvents:false,position:null,pan:0,type:null,usePolicyFile:false,volume:100};this.flash9Options={isMovieStar:null,usePeakData:false,useWaveformData:false,useEQData:false,onbufferchange:null,ondataerror:null};this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null};this.movieID="sm2-container";this.id=e||"sm2movie";
this.swfCSS={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"};this.debugID="soundmanager-debug";this.debugURLParam=/([#?&])debug=1/i;this.versionNumber="V2.97a.20111030";this.movieURL=this.version=null;this.url=b||null;this.altURL=null;this.enabled=this.swfLoaded=false;this.oMC=this.o=null;this.sounds={};this.soundIDs=[];
this.didFlashBlock=this.specialWmodeCase=this.muted=false;this.filePattern=null;this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i};this.features={buffering:false,peakData:false,waveformData:false,eqData:false,movieStar:false};this.sandbox={};var f;try{f=typeof Audio!=="undefined"&&typeof(new Audio).canPlayType!=="undefined"}catch(i){f=false}this.hasHTML5=f;this.html5={usingFlash:null};this.flash={};this.ignoreFlash=this.html5Only=false;var h,d=this,k,o=navigator.userAgent,j=a,B=j.location.href.toString(),
m=document,Z,P,l,v=[],I=false,J=false,q=false,w=false,oa=false,K,r,$,C,D,Q,pa,aa,z,R,E,ba,ca,S,F,qa,da,ra,T,sa,L=null,ea=null,A,fa,G,U,V,ga,n,W=false,ha=false,ta,ua,t=null,va,X,M,x,ia,ja,wa,p,Ea=Array.prototype.slice,N=false,s,Y,xa,u,ya,ka=o.match(/(ipad|iphone|ipod)/i),Fa=o.match(/firefox/i),Ga=o.match(/droid/i),y=o.match(/msie/i),Ha=o.match(/webkit/i),O=o.match(/safari/i)&&!o.match(/chrome/i),Ia=o.match(/opera/i);f=o.match(/(mobile|pre\/|xoom)/i)||ka;var la=!B.match(/usehtml5audio/i)&&!B.match(/sm2\-ignorebadua/i)&&
O&&o.match(/OS X 10_6_([3-7])/i),ma=typeof m.hasFocus!=="undefined"?m.hasFocus():null,H=O&&typeof m.hasFocus==="undefined",za=!H,Aa=/(mp3|mp4|mpa)/i,na=m.location?m.location.protocol.match(/http/i):null,Ba=!na?"http://":"",Ca=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|mp4v|3gp|3g2)\s*(?:$|;)/i,Da="mpeg4,aac,flv,mov,mp4,m4v,f4v,m4a,mp4v,3gp,3g2".split(","),Ja=RegExp("\\.("+Da.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i;this.useAltURL=!na;this._global_a=
null;if(f&&(d.useHTML5Audio=true,d.preferFlash=false,ka))N=d.ignoreFlash=true;this.supported=this.ok=function(){return t?q&&!w:d.useHTML5Audio&&d.hasHTML5};this.getMovie=function(a){return k(a)||m[a]||j[a]};this.createSound=function(a){function c(){b=U(b);d.sounds[f.id]=new h(f);d.soundIDs.push(f.id);return d.sounds[f.id]}var b=null,e=null,f=null;if(!q||!d.ok())return ga("soundManager.createSound(): "+A(!q?"notReady":"notOK")),false;arguments.length===2&&(a={id:arguments[0],url:arguments[1]});f=b=
r(a);if(n(f.id,true))return d.sounds[f.id];if(X(f))e=c(),e._setup_html5(f);else{if(l>8){if(f.isMovieStar===null)f.isMovieStar=f.serverURL||(f.type?f.type.match(Ca):false)||f.url.match(Ja);if(f.isMovieStar&&f.usePeakData)f.usePeakData=false}f=V(f,"soundManager.createSound(): ");e=c();if(l===8)d.o._createSound(f.id,f.loops||1,f.usePolicyFile);else if(d.o._createSound(f.id,f.url,f.usePeakData,f.useWaveformData,f.useEQData,f.isMovieStar,f.isMovieStar?f.bufferTime:false,f.loops||1,f.serverURL,f.duration||
null,f.autoPlay,true,f.autoLoad,f.usePolicyFile),!f.serverURL)e.connected=true,f.onconnect&&f.onconnect.apply(e);!f.serverURL&&(f.autoLoad||f.autoPlay)&&e.load(f)}!f.serverURL&&f.autoPlay&&e.play();return e};this.destroySound=function(a,c){if(!n(a))return false;var b=d.sounds[a],f;b._iO={};b.stop();b.unload();for(f=0;f<d.soundIDs.length;f++)if(d.soundIDs[f]===a){d.soundIDs.splice(f,1);break}c||b.destruct(true);delete d.sounds[a];return true};this.load=function(a,c){return!n(a)?false:d.sounds[a].load(c)};
this.unload=function(a){return!n(a)?false:d.sounds[a].unload()};this.onposition=function(a,c,b,f){return!n(a)?false:d.sounds[a].onposition(c,b,f)};this.start=this.play=function(a,c){return!q||!d.ok()?(ga("soundManager.play(): "+A(!q?"notReady":"notOK")),false):!n(a)?(c instanceof Object||(c={url:c}),c&&c.url?(c.id=a,d.createSound(c).play()):false):d.sounds[a].play(c)};this.setPosition=function(a,c){return!n(a)?false:d.sounds[a].setPosition(c)};this.stop=function(a){return!n(a)?false:d.sounds[a].stop()};
this.stopAll=function(){for(var a in d.sounds)d.sounds.hasOwnProperty(a)&&d.sounds[a].stop()};this.pause=function(a){return!n(a)?false:d.sounds[a].pause()};this.pauseAll=function(){var a;for(a=d.soundIDs.length;a--;)d.sounds[d.soundIDs[a]].pause()};this.resume=function(a){return!n(a)?false:d.sounds[a].resume()};this.resumeAll=function(){var a;for(a=d.soundIDs.length;a--;)d.sounds[d.soundIDs[a]].resume()};this.togglePause=function(a){return!n(a)?false:d.sounds[a].togglePause()};this.setPan=function(a,
c){return!n(a)?false:d.sounds[a].setPan(c)};this.setVolume=function(a,c){return!n(a)?false:d.sounds[a].setVolume(c)};this.mute=function(a){var c=0;typeof a!=="string"&&(a=null);if(a)return!n(a)?false:d.sounds[a].mute();else{for(c=d.soundIDs.length;c--;)d.sounds[d.soundIDs[c]].mute();d.muted=true}return true};this.muteAll=function(){d.mute()};this.unmute=function(a){typeof a!=="string"&&(a=null);if(a)return!n(a)?false:d.sounds[a].unmute();else{for(a=d.soundIDs.length;a--;)d.sounds[d.soundIDs[a]].unmute();
d.muted=false}return true};this.unmuteAll=function(){d.unmute()};this.toggleMute=function(a){return!n(a)?false:d.sounds[a].toggleMute()};this.getMemoryUse=function(){var a=0;d.o&&l!==8&&(a=parseInt(d.o._getMemoryUse(),10));return a};this.disable=function(a){var c;typeof a==="undefined"&&(a=false);if(w)return false;w=true;for(c=d.soundIDs.length;c--;)ra(d.sounds[d.soundIDs[c]]);K(a);p.remove(j,"load",D);return true};this.canPlayMIME=function(a){var c;d.hasHTML5&&(c=M({type:a}));return!t||c?c:a?!!(l>
8&&a.match(Ca)||a.match(d.mimePattern)):null};this.canPlayURL=function(a){var c;d.hasHTML5&&(c=M({url:a}));return!t||c?c:a?!!a.match(d.filePattern):null};this.canPlayLink=function(a){return typeof a.type!=="undefined"&&a.type&&d.canPlayMIME(a.type)?true:d.canPlayURL(a.href)};this.getSoundById=function(a){if(!a)throw Error("soundManager.getSoundById(): sID is null/undefined");return d.sounds[a]};this.onready=function(a,c){if(a&&a instanceof Function)return c||(c=j),$("onready",a,c),C(),true;else throw A("needFunction",
"onready");};this.ontimeout=function(a,c){if(a&&a instanceof Function)return c||(c=j),$("ontimeout",a,c),C({type:"ontimeout"}),true;else throw A("needFunction","ontimeout");};this._wD=this._writeDebug=function(){return true};this._debug=function(){};this.reboot=function(){var a,c;for(a=d.soundIDs.length;a--;)d.sounds[d.soundIDs[a]].destruct();try{if(y)ea=d.o.innerHTML;L=d.o.parentNode.removeChild(d.o)}catch(b){}ea=L=t=null;d.enabled=ba=q=W=ha=I=J=w=d.swfLoaded=false;d.soundIDs=d.sounds=[];d.o=null;
for(a in v)if(v.hasOwnProperty(a))for(c=v[a].length;c--;)v[a][c].fired=false;j.setTimeout(d.beginDelayedInit,20)};this.getMoviePercent=function(){return d.o&&typeof d.o.PercentLoaded!=="undefined"?d.o.PercentLoaded():null};this.beginDelayedInit=function(){oa=true;E();setTimeout(function(){if(ha)return false;S();R();return ha=true},20);Q()};this.destruct=function(){d.disable(true)};h=function(a){var c=this,b,f,e;this.sID=a.id;this.url=a.url;this._iO=this.instanceOptions=this.options=r(a);this.pan=
this.options.pan;this.volume=this.options.volume;this._lastURL=null;this.isHTML5=false;this._a=null;this.id3={};this._debug=function(){};this.load=function(a){var b=null;if(typeof a!=="undefined")c._iO=r(a,c.options),c.instanceOptions=c._iO;else if(a=c.options,c._iO=a,c.instanceOptions=c._iO,c._lastURL&&c._lastURL!==c.url)c._iO.url=c.url,c.url=null;if(!c._iO.url)c._iO.url=c.url;if(c._iO.url===c.url&&c.readyState!==0&&c.readyState!==2)return c;c._lastURL=c.url;c.loaded=false;c.readyState=1;c.playState=
0;if(X(c._iO)){if(b=c._setup_html5(c._iO),!b._called_load)c._html5_canplay=false,b.load(),b._called_load=true,c._iO.autoPlay&&c.play()}else try{c.isHTML5=false,c._iO=V(U(c._iO)),l===8?d.o._load(c.sID,c._iO.url,c._iO.stream,c._iO.autoPlay,c._iO.whileloading?1:0,c._iO.loops||1,c._iO.usePolicyFile):d.o._load(c.sID,c._iO.url,!!c._iO.stream,!!c._iO.autoPlay,c._iO.loops||1,!!c._iO.autoLoad,c._iO.usePolicyFile)}catch(f){F({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:true})}return c};this.unload=function(){c.readyState!==
0&&(c.isHTML5?(f(),c._a&&(c._a.pause(),ia(c._a))):l===8?d.o._unload(c.sID,"about:blank"):d.o._unload(c.sID),b());return c};this.destruct=function(a){if(c.isHTML5){if(f(),c._a)c._a.pause(),ia(c._a),N||c._remove_html5_events(),c._a._t=null,c._a=null}else c._iO.onfailure=null,d.o._destroySound(c.sID);a||d.destroySound(c.sID,true)};this.start=this.play=function(a,b){var f,b=b===void 0?true:b;a||(a={});c._iO=r(a,c._iO);c._iO=r(c._iO,c.options);c.instanceOptions=c._iO;if(c._iO.serverURL&&!c.connected)return c.getAutoPlay()||
c.setAutoPlay(true),c;X(c._iO)&&(c._setup_html5(c._iO),e());if(c.playState===1&&!c.paused&&(f=c._iO.multiShot,!f))return c;if(!c.loaded)if(c.readyState===0){if(!c.isHTML5)c._iO.autoPlay=true;c.load(c._iO)}else if(c.readyState===2)return c;if(!c.isHTML5&&l===9&&c.position>0&&c.position===c.duration)c._iO.position=0;if(c.paused&&c.position&&c.position>0)c.resume();else{c.playState=1;c.paused=false;(!c.instanceCount||c._iO.multiShotEvents||!c.isHTML5&&l>8&&!c.getAutoPlay())&&c.instanceCount++;c.position=
typeof c._iO.position!=="undefined"&&!isNaN(c._iO.position)?c._iO.position:0;if(!c.isHTML5)c._iO=V(U(c._iO));if(c._iO.onplay&&b)c._iO.onplay.apply(c),c._onplay_called=true;c.setVolume(c._iO.volume,true);c.setPan(c._iO.pan,true);c.isHTML5?(e(),f=c._setup_html5(),c.setPosition(c._iO.position),f.play()):d.o._start(c.sID,c._iO.loops||1,l===9?c._iO.position:c._iO.position/1E3)}return c};this.stop=function(a){if(c.playState===1){c._onbufferchange(0);c.resetOnPosition(0);c.paused=false;if(!c.isHTML5)c.playState=
0;c._iO.onstop&&c._iO.onstop.apply(c);if(c.isHTML5){if(c._a)c.setPosition(0),c._a.pause(),c.playState=0,c._onTimer(),f()}else d.o._stop(c.sID,a),c._iO.serverURL&&c.unload();c.instanceCount=0;c._iO={}}return c};this.setAutoPlay=function(a){c._iO.autoPlay=a;c.isHTML5||(d.o._setAutoPlay(c.sID,a),a&&!c.instanceCount&&c.readyState===1&&c.instanceCount++)};this.getAutoPlay=function(){return c._iO.autoPlay};this.setPosition=function(a){a===void 0&&(a=0);var b=c.isHTML5?Math.max(a,0):Math.min(c.duration||
c._iO.duration,Math.max(a,0));c.position=b;a=c.position/1E3;c.resetOnPosition(c.position);c._iO.position=b;if(c.isHTML5){if(c._a&&c._html5_canplay&&c._a.currentTime!==a)try{c._a.currentTime=a,(c.playState===0||c.paused)&&c._a.pause()}catch(f){}}else a=l===9?c.position:a,c.readyState&&c.readyState!==2&&d.o._setPosition(c.sID,a,c.paused||!c.playState);c.isHTML5&&c.paused&&c._onTimer(true);return c};this.pause=function(a){if(c.paused||c.playState===0&&c.readyState!==1)return c;c.paused=true;c.isHTML5?
(c._setup_html5().pause(),f()):(a||a===void 0)&&d.o._pause(c.sID);c._iO.onpause&&c._iO.onpause.apply(c);return c};this.resume=function(){if(!c.paused)return c;c.paused=false;c.playState=1;c.isHTML5?(c._setup_html5().play(),e()):(c._iO.isMovieStar&&c.setPosition(c.position),d.o._pause(c.sID));!c._onplay_called&&c._iO.onplay?(c._iO.onplay.apply(c),c._onplay_called=true):c._iO.onresume&&c._iO.onresume.apply(c);return c};this.togglePause=function(){if(c.playState===0)return c.play({position:l===9&&!c.isHTML5?
c.position:c.position/1E3}),c;c.paused?c.resume():c.pause();return c};this.setPan=function(a,b){typeof a==="undefined"&&(a=0);typeof b==="undefined"&&(b=false);c.isHTML5||d.o._setPan(c.sID,a);c._iO.pan=a;if(!b)c.pan=a,c.options.pan=a;return c};this.setVolume=function(a,b){typeof a==="undefined"&&(a=100);typeof b==="undefined"&&(b=false);if(c.isHTML5){if(c._a)c._a.volume=Math.max(0,Math.min(1,a/100))}else d.o._setVolume(c.sID,d.muted&&!c.muted||c.muted?0:a);c._iO.volume=a;if(!b)c.volume=a,c.options.volume=
a;return c};this.mute=function(){c.muted=true;if(c.isHTML5){if(c._a)c._a.muted=true}else d.o._setVolume(c.sID,0);return c};this.unmute=function(){c.muted=false;var a=typeof c._iO.volume!=="undefined";if(c.isHTML5){if(c._a)c._a.muted=false}else d.o._setVolume(c.sID,a?c._iO.volume:c.options.volume);return c};this.toggleMute=function(){return c.muted?c.unmute():c.mute()};this.onposition=function(a,b,f){c._onPositionItems.push({position:a,method:b,scope:typeof f!=="undefined"?f:c,fired:false});return c};
this.processOnPosition=function(){var a,b;a=c._onPositionItems.length;if(!a||!c.playState||c._onPositionFired>=a)return false;for(;a--;)if(b=c._onPositionItems[a],!b.fired&&c.position>=b.position)b.fired=true,d._onPositionFired++,b.method.apply(b.scope,[b.position]);return true};this.resetOnPosition=function(a){var b,f;b=c._onPositionItems.length;if(!b)return false;for(;b--;)if(f=c._onPositionItems[b],f.fired&&a<=f.position)f.fired=false,d._onPositionFired--;return true};e=function(){c.isHTML5&&ta(c)};
f=function(){c.isHTML5&&ua(c)};b=function(){c._onPositionItems=[];c._onPositionFired=0;c._hasTimer=null;c._onplay_called=false;c._a=null;c._html5_canplay=false;c.bytesLoaded=null;c.bytesTotal=null;c.position=null;c.duration=c._iO&&c._iO.duration?c._iO.duration:null;c.durationEstimate=null;c.failures=0;c.loaded=false;c.playState=0;c.paused=false;c.readyState=0;c.muted=false;c.isBuffering=false;c.instanceOptions={};c.instanceCount=0;c.peakData={left:0,right:0};c.waveformData={left:[],right:[]};c.eqData=
[];c.eqData.left=[];c.eqData.right=[]};b();this._onTimer=function(a){var b={};if(c._hasTimer||a)return c._a&&(a||(c.playState>0||c.readyState===1)&&!c.paused)?(c.duration=c._get_html5_duration(),c.durationEstimate=c.duration,a=c._a.currentTime?c._a.currentTime*1E3:0,c._whileplaying(a,b,b,b,b),true):false};this._get_html5_duration=function(){var a=c._a?c._a.duration*1E3:c._iO?c._iO.duration:void 0;return a&&!isNaN(a)&&a!==Infinity?a:c._iO?c._iO.duration:null};this._setup_html5=function(a){var a=r(c._iO,
a),f=N?d._global_a:c._a;decodeURI(a.url);var e=f&&f._t?f._t.instanceOptions:null;if(f){if(f._t&&e.url===a.url&&(!c._lastURL||c._lastURL===e.url))return f;N&&f._t&&f._t.playState&&a.url!==e.url&&f._t.stop();b();f.src=a.url;c.url=a.url;c._lastURL=a.url;f._called_load=false}else{f=new Audio(a.url);f._called_load=false;if(Ga)f._called_load=true;if(N)d._global_a=f}c.isHTML5=true;c._a=f;f._t=c;c._add_html5_events();f.loop=a.loops>1?"loop":"";a.autoLoad||a.autoPlay?(f.autobuffer="auto",f.preload="auto",
c.load(),f._called_load=true):(f.autobuffer=false,f.preload="none");f.loop=a.loops>1?"loop":"";return f};this._add_html5_events=function(){if(c._a._added_events)return false;var a;c._a._added_events=true;for(a in u)u.hasOwnProperty(a)&&c._a&&c._a.addEventListener(a,u[a],false);return true};this._remove_html5_events=function(){var a;c._a._added_events=false;for(a in u)u.hasOwnProperty(a)&&c._a&&c._a.removeEventListener(a,u[a],false)};this._onload=function(a){a=!!a;c.loaded=a;c.readyState=a?3:2;c._onbufferchange(0);
c._iO.onload&&c._iO.onload.apply(c,[a]);return true};this._onbufferchange=function(a){if(c.playState===0)return false;if(a&&c.isBuffering||!a&&!c.isBuffering)return false;c.isBuffering=a===1;c._iO.onbufferchange&&c._iO.onbufferchange.apply(c);return true};this._onsuspend=function(){c._iO.onsuspend&&c._iO.onsuspend.apply(c);return true};this._onfailure=function(a,b,f){c.failures++;if(c._iO.onfailure&&c.failures===1)c._iO.onfailure(c,a,b,f)};this._onfinish=function(){var a=c._iO.onfinish;c._onbufferchange(0);
c.resetOnPosition(0);if(c.instanceCount){c.instanceCount--;if(!c.instanceCount)c.playState=0,c.paused=false,c.instanceCount=0,c.instanceOptions={},c._iO={},f();(!c.instanceCount||c._iO.multiShotEvents)&&a&&a.apply(c)}};this._whileloading=function(a,b,f,d){c.bytesLoaded=a;c.bytesTotal=b;c.duration=Math.floor(f);c.bufferLength=d;if(c._iO.isMovieStar)c.durationEstimate=c.duration;else if(c.durationEstimate=c._iO.duration?c.duration>c._iO.duration?c.duration:c._iO.duration:parseInt(c.bytesTotal/c.bytesLoaded*
c.duration,10),c.durationEstimate===void 0)c.durationEstimate=c.duration;c.readyState!==3&&c._iO.whileloading&&c._iO.whileloading.apply(c)};this._whileplaying=function(a,b,f,d,e){if(isNaN(a)||a===null)return false;c.position=a;c.processOnPosition();if(!c.isHTML5&&l>8){if(c._iO.usePeakData&&typeof b!=="undefined"&&b)c.peakData={left:b.leftPeak,right:b.rightPeak};if(c._iO.useWaveformData&&typeof f!=="undefined"&&f)c.waveformData={left:f.split(","),right:d.split(",")};if(c._iO.useEQData&&typeof e!==
"undefined"&&e&&e.leftEQ&&(a=e.leftEQ.split(","),c.eqData=a,c.eqData.left=a,typeof e.rightEQ!=="undefined"&&e.rightEQ))c.eqData.right=e.rightEQ.split(",")}c.playState===1&&(!c.isHTML5&&l===8&&!c.position&&c.isBuffering&&c._onbufferchange(0),c._iO.whileplaying&&c._iO.whileplaying.apply(c));return true};this._onid3=function(a,b){var f=[],d,e;for(d=0,e=a.length;d<e;d++)f[a[d]]=b[d];c.id3=r(c.id3,f);c._iO.onid3&&c._iO.onid3.apply(c)};this._onconnect=function(a){a=a===1;if(c.connected=a)c.failures=0,n(c.sID)&&
(c.getAutoPlay()?c.play(void 0,c.getAutoPlay()):c._iO.autoLoad&&c.load()),c._iO.onconnect&&c._iO.onconnect.apply(c,[a])};this._ondataerror=function(){c.playState>0&&c._iO.ondataerror&&c._iO.ondataerror.apply(c)}};ca=function(){return m.body||m._docElement||m.getElementsByTagName("div")[0]};k=function(a){return m.getElementById(a)};r=function(a,c){var b={},f,e;for(f in a)a.hasOwnProperty(f)&&(b[f]=a[f]);f=typeof c==="undefined"?d.defaultOptions:c;for(e in f)f.hasOwnProperty(e)&&typeof b[e]==="undefined"&&
(b[e]=f[e]);return b};p=function(){function a(c){var c=Ea.call(c),f=c.length;b?(c[1]="on"+c[1],f>3&&c.pop()):f===3&&c.push(false);return c}function c(a,c){var d=a.shift(),e=[f[c]];if(b)d[e](a[0],a[1]);else d[e].apply(d,a)}var b=j.attachEvent,f={add:b?"attachEvent":"addEventListener",remove:b?"detachEvent":"removeEventListener"};return{add:function(){c(a(arguments),"add")},remove:function(){c(a(arguments),"remove")}}}();u={abort:g(function(){}),canplay:g(function(){if(this._t._html5_canplay)return true;
this._t._html5_canplay=true;this._t._onbufferchange(0);var a=!isNaN(this._t.position)?this._t.position/1E3:null;if(this._t.position&&this.currentTime!==a)try{this.currentTime=a}catch(c){}}),load:g(function(){this._t.loaded||(this._t._onbufferchange(0),this._t._whileloading(this._t.bytesTotal,this._t.bytesTotal,this._t._get_html5_duration()),this._t._onload(true))}),emptied:g(function(){}),ended:g(function(){this._t._onfinish()}),error:g(function(){this._t._onload(false)}),loadeddata:g(function(){var a=
this._t,c=a.bytesTotal||1;if(!a._loaded&&!O)a.duration=a._get_html5_duration(),a._whileloading(c,c,a._get_html5_duration()),a._onload(true)}),loadedmetadata:g(function(){}),loadstart:g(function(){this._t._onbufferchange(1)}),play:g(function(){this._t._onbufferchange(0)}),playing:g(function(){this._t._onbufferchange(0)}),progress:g(function(a){if(this._t.loaded)return false;var c,b=0,f=a.target.buffered;c=a.loaded||0;var d=a.total||1;if(f&&f.length){for(c=f.length;c--;)b=f.end(c)-f.start(c);c=b/a.target.duration}isNaN(c)||
(this._t._onbufferchange(0),this._t._whileloading(c,d,this._t._get_html5_duration()),c&&d&&c===d&&u.load.call(this,a))}),ratechange:g(function(){}),suspend:g(function(a){u.progress.call(this,a);this._t._onsuspend()}),stalled:g(function(){}),timeupdate:g(function(){this._t._onTimer()}),waiting:g(function(){this._t._onbufferchange(1)})};X=function(a){return!a.serverURL&&(a.type?M({type:a.type}):M({url:a.url})||d.html5Only)};ia=function(a){if(a)a.src=Fa?"":"about:blank"};M=function(a){function c(a){return d.preferFlash&&
s&&!d.ignoreFlash&&typeof d.flash[a]!=="undefined"&&d.flash[a]}if(!d.useHTML5Audio||!d.hasHTML5)return false;var b=a.url||null,a=a.type||null,f=d.audioFormats,e;if(a&&d.html5[a]!=="undefined")return d.html5[a]&&!c(a);if(!x){x=[];for(e in f)f.hasOwnProperty(e)&&(x.push(e),f[e].related&&(x=x.concat(f[e].related)));x=RegExp("\\.("+x.join("|")+")(\\?.*)?$","i")}e=b?b.toLowerCase().match(x):null;if(!e||!e.length)if(a)b=a.indexOf(";"),e=(b!==-1?a.substr(0,b):a).substr(6);else return false;else e=e[1];return e&&
typeof d.html5[e]!=="undefined"?d.html5[e]&&!c(e):(a="audio/"+e,b=d.html5.canPlayType({type:a}),(d.html5[e]=b)&&d.html5[a]&&!c(a))};wa=function(){function a(b){var f,e,g=false;if(!c||typeof c.canPlayType!=="function")return false;if(b instanceof Array){for(f=0,e=b.length;f<e&&!g;f++)if(d.html5[b[f]]||c.canPlayType(b[f]).match(d.html5Test))g=true,d.html5[b[f]]=true,d.flash[b[f]]=!(!d.preferFlash||!s||!b[f].match(Aa));return g}else return b=c&&typeof c.canPlayType==="function"?c.canPlayType(b):false,
!(!b||!b.match(d.html5Test))}if(!d.useHTML5Audio||typeof Audio==="undefined")return false;var c=typeof Audio!=="undefined"?Ia?new Audio(null):new Audio:null,b,f={},e,g;e=d.audioFormats;for(b in e)if(e.hasOwnProperty(b)&&(f[b]=a(e[b].type),f["audio/"+b]=f[b],d.flash[b]=d.preferFlash&&!d.ignoreFlash&&b.match(Aa)?true:false,e[b]&&e[b].related))for(g=e[b].related.length;g--;)f["audio/"+e[b].related[g]]=f[b],d.html5[e[b].related[g]]=f[b],d.flash[e[b].related[g]]=f[b];f.canPlayType=c?a:null;d.html5=r(d.html5,
f);return true};A=function(){};U=function(a){if(l===8&&a.loops>1&&a.stream)a.stream=false;return a};V=function(a){if(a&&!a.usePolicyFile&&(a.onid3||a.usePeakData||a.useWaveformData||a.useEQData))a.usePolicyFile=true;return a};ga=function(){};Z=function(){return false};ra=function(a){for(var c in a)a.hasOwnProperty(c)&&typeof a[c]==="function"&&(a[c]=Z)};T=function(a){typeof a==="undefined"&&(a=false);(w||a)&&d.disable(a)};sa=function(a){if(a)if(a.match(/\.swf(\?.*)?$/i)){if(a.substr(a.toLowerCase().lastIndexOf(".swf?")+
4))return a}else a.lastIndexOf("/")!==a.length-1&&(a+="/");a=(a&&a.lastIndexOf("/")!==-1?a.substr(0,a.lastIndexOf("/")+1):"./")+d.movieURL;d.noSWFCache&&(a+="?ts="+(new Date).getTime());return a};aa=function(){l=parseInt(d.flashVersion,10);if(l!==8&&l!==9)d.flashVersion=l=8;var a=d.debugMode||d.debugFlash?"_debug.swf":".swf";if(d.useHTML5Audio&&!d.html5Only&&d.audioFormats.mp4.required&&l<9)d.flashVersion=l=9;d.version=d.versionNumber+(d.html5Only?" (HTML5-only mode)":l===9?" (AS3/Flash 9)":" (AS2/Flash 8)");
l>8?(d.defaultOptions=r(d.defaultOptions,d.flash9Options),d.features.buffering=true,d.defaultOptions=r(d.defaultOptions,d.movieStarOptions),d.filePatterns.flash9=RegExp("\\.(mp3|"+Da.join("|")+")(\\?.*)?$","i"),d.features.movieStar=true):d.features.movieStar=false;d.filePattern=d.filePatterns[l!==8?"flash9":"flash8"];d.movieURL=(l===8?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",a);d.features.peakData=d.features.waveformData=d.features.eqData=l>8};qa=function(a,c){if(!d.o)return false;
d.o._setPolling(a,c)};da=function(){if(d.debugURLParam.test(B))d.debugMode=true};n=this.getSoundById;G=function(){var a=[];d.debugMode&&a.push(d.swfCSS.sm2Debug);d.debugFlash&&a.push(d.swfCSS.flashDebug);d.useHighPerformance&&a.push(d.swfCSS.highPerf);return a.join(" ")};fa=function(){A("fbHandler");var a=d.getMoviePercent(),c=d.swfCSS,b={type:"FLASHBLOCK"};if(d.html5Only)return false;if(d.ok()){if(d.oMC)d.oMC.className=[G(),c.swfDefault,c.swfLoaded+(d.didFlashBlock?" "+c.swfUnblocked:"")].join(" ")}else{if(t)d.oMC.className=
G()+" "+c.swfDefault+" "+(a===null?c.swfTimedout:c.swfError);d.didFlashBlock=true;C({type:"ontimeout",ignoreInit:true,error:b});F(b)}};$=function(a,c,b){typeof v[a]==="undefined"&&(v[a]=[]);v[a].push({method:c,scope:b||null,fired:false})};C=function(a){a||(a={type:"onready"});if(!q&&a&&!a.ignoreInit)return false;if(a.type==="ontimeout"&&d.ok())return false;var c={success:a&&a.ignoreInit?d.ok():!w},b=a&&a.type?v[a.type]||[]:[],f=[],e,c=[c],g=t&&d.useFlashBlock&&!d.ok();if(a.error)c[0].error=a.error;
for(a=0,e=b.length;a<e;a++)b[a].fired!==true&&f.push(b[a]);if(f.length)for(a=0,e=f.length;a<e;a++)if(f[a].scope?f[a].method.apply(f[a].scope,c):f[a].method.apply(this,c),!g)f[a].fired=true;return true};D=function(){j.setTimeout(function(){d.useFlashBlock&&fa();C();d.onload instanceof Function&&d.onload.apply(j);d.waitForWindowLoad&&p.add(j,"load",D)},1)};Y=function(){if(s!==void 0)return s;var a=false,c=navigator,b=c.plugins,f,e=j.ActiveXObject;if(b&&b.length)(c=c.mimeTypes)&&c["application/x-shockwave-flash"]&&
c["application/x-shockwave-flash"].enabledPlugin&&c["application/x-shockwave-flash"].enabledPlugin.description&&(a=true);else if(typeof e!=="undefined"){try{f=new e("ShockwaveFlash.ShockwaveFlash")}catch(d){}a=!!f}return s=a};va=function(){var a,c;if(ka&&o.match(/os (1|2|3_0|3_1)/i)){d.hasHTML5=false;d.html5Only=true;if(d.oMC)d.oMC.style.display="none";return false}if(d.useHTML5Audio){if(!d.html5||!d.html5.canPlayType)return d.hasHTML5=false,true;else d.hasHTML5=true;if(la&&Y())return true}else return true;
for(c in d.audioFormats)if(d.audioFormats.hasOwnProperty(c)&&(d.audioFormats[c].required&&!d.html5.canPlayType(d.audioFormats[c].type)||d.flash[c]||d.flash[d.audioFormats[c].type]))a=true;d.ignoreFlash&&(a=false);d.html5Only=d.hasHTML5&&d.useHTML5Audio&&!a;return!d.html5Only};ta=function(a){if(!a._hasTimer)a._hasTimer=true};ua=function(a){if(a._hasTimer)a._hasTimer=false};F=function(a){a=typeof a!=="undefined"?a:{};d.onerror instanceof Function&&d.onerror.apply(j,[{type:typeof a.type!=="undefined"?
a.type:null}]);typeof a.fatal!=="undefined"&&a.fatal&&d.disable()};xa=function(){if(!la||!Y())return false;var a=d.audioFormats,c,b;for(b in a)if(a.hasOwnProperty(b)&&(b==="mp3"||b==="mp4"))if(d.html5[b]=false,a[b]&&a[b].related)for(c=a[b].related.length;c--;)d.html5[a[b].related[c]]=false};this._setSandboxType=function(){};this._externalInterfaceOK=function(){if(d.swfLoaded)return false;(new Date).getTime();d.swfLoaded=true;H=false;la&&xa();y?setTimeout(P,100):P()};S=function(a,c){function b(a,c){return'<param name="'+
a+'" value="'+c+'" />'}if(I&&J)return false;if(d.html5Only)return aa(),d.oMC=k(d.movieID),P(),J=I=true,false;var f=c||d.url,e=d.altURL||f,g;g=ca();var i,h,j=G(),l,n=null,n=(n=m.getElementsByTagName("html")[0])&&n.dir&&n.dir.match(/rtl/i),a=typeof a==="undefined"?d.id:a;aa();d.url=sa(na?f:e);c=d.url;d.wmode=!d.wmode&&d.useHighPerformance?"transparent":d.wmode;if(d.wmode!==null&&(o.match(/msie 8/i)||!y&&!d.useHighPerformance)&&navigator.platform.match(/win32|win64/i))d.specialWmodeCase=true,d.wmode=
null;g={name:a,id:a,src:c,width:"auto",height:"auto",quality:"high",allowScriptAccess:d.allowScriptAccess,bgcolor:d.bgColor,pluginspage:Ba+"www.macromedia.com/go/getflashplayer",title:"JS/Flash audio component (SoundManager 2)",type:"application/x-shockwave-flash",wmode:d.wmode,hasPriority:"true"};if(d.debugFlash)g.FlashVars="debug=1";d.wmode||delete g.wmode;if(y)f=m.createElement("div"),h=['<object id="'+a+'" data="'+c+'" type="'+g.type+'" title="'+g.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+
Ba+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" width="'+g.width+'" height="'+g.height+'">',b("movie",c),b("AllowScriptAccess",d.allowScriptAccess),b("quality",g.quality),d.wmode?b("wmode",d.wmode):"",b("bgcolor",d.bgColor),b("hasPriority","true"),d.debugFlash?b("FlashVars",g.FlashVars):"","</object>"].join("");else for(i in f=m.createElement("embed"),g)g.hasOwnProperty(i)&&f.setAttribute(i,g[i]);da();j=G();if(g=ca())if(d.oMC=k(d.movieID)||m.createElement("div"),
d.oMC.id){l=d.oMC.className;d.oMC.className=(l?l+" ":d.swfCSS.swfDefault)+(j?" "+j:"");d.oMC.appendChild(f);if(y)i=d.oMC.appendChild(m.createElement("div")),i.className=d.swfCSS.swfBox,i.innerHTML=h;J=true}else{d.oMC.id=d.movieID;d.oMC.className=d.swfCSS.swfDefault+" "+j;i=j=null;if(!d.useFlashBlock)if(d.useHighPerformance)j={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"};else if(j={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},n)j.left=
Math.abs(parseInt(j.left,10))+"px";if(Ha)d.oMC.style.zIndex=1E4;if(!d.debugFlash)for(l in j)j.hasOwnProperty(l)&&(d.oMC.style[l]=j[l]);try{y||d.oMC.appendChild(f);g.appendChild(d.oMC);if(y)i=d.oMC.appendChild(m.createElement("div")),i.className=d.swfCSS.swfBox,i.innerHTML=h;J=true}catch(p){throw Error(A("domError")+" \n"+p.toString());}}return I=true};R=function(){if(d.html5Only)return S(),false;if(d.o)return false;d.o=d.getMovie(d.id);if(!d.o)L?(y?d.oMC.innerHTML=ea:d.oMC.appendChild(L),L=null,I=
true):S(d.id,d.url),d.o=d.getMovie(d.id);d.oninitmovie instanceof Function&&setTimeout(d.oninitmovie,1);return true};Q=function(){setTimeout(pa,1E3)};pa=function(){if(W)return false;W=true;p.remove(j,"load",Q);if(H&&!ma)return false;var a;q||(a=d.getMoviePercent());setTimeout(function(){a=d.getMoviePercent();!q&&za&&(a===null?d.useFlashBlock||d.flashLoadTimeout===0?d.useFlashBlock&&fa():T(true):d.flashLoadTimeout!==0&&T(true))},d.flashLoadTimeout)};z=function(){function a(){p.remove(j,"focus",z);
p.remove(j,"load",z)}if(ma||!H)return a(),true;ma=za=true;O&&H&&p.remove(j,"mousemove",z);W=false;a();return true};ya=function(){var a,c=[];if(d.useHTML5Audio&&d.hasHTML5)for(a in d.audioFormats)d.audioFormats.hasOwnProperty(a)&&c.push(a+": "+d.html5[a]+(!d.html5[a]&&s&&d.flash[a]?" (using flash)":d.preferFlash&&d.flash[a]&&s?" (preferring flash)":!d.html5[a]?" ("+(d.audioFormats[a].required?"required, ":"")+"and no flash support)":""))};K=function(a){if(q)return false;if(d.html5Only)return q=true,
D(),true;var c;if(!d.useFlashBlock||!d.flashLoadTimeout||d.getMoviePercent())q=true,w&&(c={type:!s&&t?"NO_FLASH":"INIT_TIMEOUT"});if(w||a){if(d.useFlashBlock&&d.oMC)d.oMC.className=G()+" "+(d.getMoviePercent()===null?d.swfCSS.swfTimedout:d.swfCSS.swfError);C({type:"ontimeout",error:c});F(c);return false}if(d.waitForWindowLoad&&!oa)return p.add(j,"load",D),false;else D();return true};P=function(){if(q)return false;if(d.html5Only){if(!q)p.remove(j,"load",d.beginDelayedInit),d.enabled=true,K();return true}R();
try{d.o._externalInterfaceTest(false),qa(true,d.flashPollingInterval||(d.useHighPerformance?10:50)),d.debugMode||d.o._disableDebug(),d.enabled=true,d.html5Only||p.add(j,"unload",Z)}catch(a){return F({type:"JS_TO_FLASH_EXCEPTION",fatal:true}),T(true),K(),false}K();p.remove(j,"load",d.beginDelayedInit);return true};E=function(){if(ba)return false;ba=true;da();if(!s&&d.hasHTML5)d.useHTML5Audio=true,d.preferFlash=false;wa();d.html5.usingFlash=va();t=d.html5.usingFlash;ya();if(!s&&t)d.flashLoadTimeout=
1;m.removeEventListener&&m.removeEventListener("DOMContentLoaded",E,false);R();return true};ja=function(){m.readyState==="complete"&&(E(),m.detachEvent("onreadystatechange",ja));return true};Y();p.add(j,"focus",z);p.add(j,"load",z);p.add(j,"load",Q);O&&H&&p.add(j,"mousemove",z);m.addEventListener?m.addEventListener("DOMContentLoaded",E,false):m.attachEvent?m.attachEvent("onreadystatechange",ja):F({type:"NO_DOM2_EVENTS",fatal:true});m.readyState==="complete"&&setTimeout(E,100)};a.soundManager=null})(window);pulse=pulse||{};pulse.plugin=pulse.plugin||{};
pulse.plugin.Plugin=PClass.extend({init:function(){this._private={};this._private.types={}},subscribe:function(a,b,e,g){g=new pulse.plugin.PluginCallback({objectType:a,functionName:b,callbackType:e,callback:g,pluginManager:this});this._private.types[a]==void 0&&(this._private.types[a]={});this._private.types[a][b]==void 0&&(this._private.types[a][b]={});this._private.types[a][b][e]==void 0&&(this._private.types[a][b][e]=[]);this._private.types[a][b][e].push(g);return g},invoke:function(a,b,e,g,f){if(typeof this._private.types[a]!==
pulse.plugin._UNDEFINED&&typeof this._private.types[a][b]!==pulse.plugin._UNDEFINED&&typeof this._private.types[a][b][e]!==pulse.plugin._UNDEFINED)for(var i=this._private.types[a][b][e].length,h=0;h<i;h++)this._private.types[a][b][e][h].callback.apply(g,f)},unsubscribe:function(a){if(this._private.types[a.objectType]!=void 0&&this._private.types[a.objectType][a.functionName]!=void 0&&this._private.types[a.objectType][a.functionName][a.callbackType]!=void 0){var b=this._private.types[a.objectType][a.functionName][a.callbackType],
e;for(e in b)b[e]==a&&b.splice(e,1)}}});pulse.plugin.PluginCallback=PClass.extend({init:function(a){this.objectType=a.objectType;this.functionName=a.functionName;this.callbackType=a.callbackType;this.callback=a.callback}});pulse.plugin.PluginCallbackTypes={onEnter:"onEnter",onExit:"onExit"};pulse.plugin._UNDEFINED="undefined";pulse=pulse||{};pulse.plugin=pulse.plugin||{};pulse.plugin.PluginCollection=PClass.extend({init:function(){this._private={};this._private.plugins=[]},add:function(a){this._private.plugins.push(a)},remove:function(a){for(var b in this._private.plugins)this._private.plugins[b]===a&&this._private.plugins.splice(b,1)},invoke:function(a,b,e,g,f){for(var i=this._private.plugins.length,h=0;h<i;h++)this._private.plugins[h].invoke(a,b,e,g,f)}});pulse.plugins=pulse.plugins||new pulse.plugin.PluginCollection;pulse=pulse||{};pulse.error={DuplicateName:function(a){throw"There is already an object with the name "+a+" on this layer.";},InvalidSource:function(){throw"Invalid source for pulse image.";}};pulse=pulse||{};pulse.util=pulse.util||{};pulse.util.find=function(a,b){var e=[];if(a instanceof Array)for(var g=0;g<a.length;g++)typeof a[g]=="function"&&typeof a[g].name=="function"&&a[g].name==b&&e.push(a[g]);else if(typeof a=="object")for(g in a)g==b&&e.push(a[g]);return e};pulse.util.intersects=function(a,b){for(var e=[{x:a.x,y:a.y},{x:a.x,y:a.y+a.height},{x:a.x+a.width,y:a.y},{x:a.x+a.width,y:a.y+a.height}],g=0;g<4;g++){var f=e[g];if(f.x<b.width&&f.x>b.x&&f.y<b.height&&f.y>b.y)return true}return false};
pulse.util.checkValue=function(a,b){a===null&&(a=b);return a};pulse.util.checkProperty=function(a,b,e){typeof a=="undefined"&&(a={});if(!a.hasOwnProperty(b)||a[b]===null)a[b]=e;return a};pulse.util.checkParams=function(a,b){if(typeof a=="undefined"||a===null||typeof a!="object")a={};for(var e in b)if(!a.hasOwnProperty(e)||a[e]===null)a[e]=b[e];return a};pulse.util.getLength=function(a){var b=0,e;for(e in a)a.hasOwnProperty(e)&&b++;return b};
pulse.util.compareZIndexes=function(a,b){var e=0;if(a.hasOwnProperty("zindex"))e=a.zindex;var g=0;if(b.hasOwnProperty("zindex"))g=b.zindex;return e<g?-1:e>g?1:0};pulse.util.getOrderedKeys=function(a){var b=[],e;for(e in a)a[e].hasOwnProperty("name")&&b.push(a[e]);b.sort(pulse.util.compareZIndexes);a=[];for(e=0;e<b.length;e++)a.push(b[e].name);return a};
pulse.util.getIFrame=function(a){var b=document.createElement("iframe");if(a===null)a=document.body;a.appendChild(b);b.doc=null;if(b.contentDocument)b.doc=b.contentDocument;else if(b.contentWindow)b.doc=b.contentWindow.document;else if(b.document)b.doc=b.document;if(b.doc===null)throw"Document not found, append the parent element to the DOM before creating the IFrame";b.doc.open();b.doc.close();return b};pulse.util.easeLinear=function(a,b,e,g){return e*a/g+b};
pulse.util.easeInQuad=function(a,b,e,g){a/=g;return e*a*a+b};pulse.util.easeOutQuad=function(a,b,e,g){a/=g;return-e*a*(a-2)+b};pulse.util.easeInOutQuad=function(a,b,e,g){a/=g/2;if(a<1)return e/2*a*a+b;a--;return-e/2*(a*(a-2)-1)+b};pulse.util.easeOutCubic=function(a,b,e,g){a/=g;a--;return e*(a*a*a+1)+b};pulse.util.eventSupported=function(a){var b=document.createElement("canvas");return"on"+a in b};pulse=pulse||{};pulse.Point=PClass.extend({init:function(a){a=pulse.util.checkParams(a,{x:0,y:0});this.x=a.x;this.y=a.y}});pulse=pulse||{};pulse.support=pulse.support||{};pulse.support.touch=false;pulse.ready(function(){pulse.support.touch=pulse.util.eventSupported("touchstart")});pulse=pulse||{};pulse.Event=PClass.extend({init:function(){this.sender=null}});pulse.MouseEvent=pulse.Event.extend({init:function(){this._super();this.window={x:0,y:0};this.world={x:0,y:0};this.parent={x:0,y:0};this.position={x:0,y:0};this.scrollDelta=0}});pulse.TouchEvent=pulse.MouseEvent.extend({init:function(){this._super();this.touches=[];this.changedTouches=[];this.targetTouches=[];this.gestureScale=1;this.gestureRotation=0}});pulse=pulse||{};
pulse.EventManager=PClass.extend({init:function(a){a=pulse.util.checkParams(a,{owner:null,masterCallback:null});this.owner=a.owner;this.masterCallback=a.masterCallback;this._private={};this._private.events={};this._private.touchDown=false},bind:function(a,b){var e=this.checkType(a);this._private.events.hasOwnProperty(e)||(this._private.events[e]=[]);this._private.events[e].push(b)},unbind:function(a){a=this.checkType(a);this._private.events.hasOwnProperty(a)&&delete this._private.events[a]},unbindFunction:function(a,
b){var e=this.checkType(a);if(this._private.events.hasOwnProperty(e))for(var g=this._private.events[e].length-1;g>=0;g--)this._private.events[e][g]===b&&this._private.events[e].splice(g,1)},hasEvent:function(a){return this._private.events.hasOwnProperty(a)?true:false},raiseEvent:function(a,b){if(a==="touchstart"&&this._private.touchDown===false)this._private.touchDown=true;else if(a==="touchend"&&this._private.touchDown===true)this.raiseEvent("touchclick",b);else if(a==="touchclick"||a==="mouseout")this._private.touchDown=
false;if(this.hasEvent(a))for(var e=0;e<this._private.events[a].length;e++)this._private.events[a][e](b);typeof this.masterCallback==="function"&&(this.owner?this.masterCallback.call(this.owner,a,b):this.masterCallback(a,b))},checkType:function(a){if(a==="click"&&pulse.util.eventSupported("touchend"))return"touchclick";for(var b in pulse.eventtranslations)if(a===pulse.eventtranslations[b]&&pulse.util.eventSupported(b))return b;return a}});pulse.EventManager.DraggedItems={};pulse=pulse||{};
pulse.Node=PClass.extend({init:function(a){pulse.plugins.invoke("pulse.Node","init",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);a=pulse.util.checkParams(a,{name:"Node"+pulse.Node.nodeIdx++});this.name=a.name;this.parent=null;this._private={};pulse.plugins.invoke("pulse.Node","init",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},update:function(a){pulse.plugins.invoke(pulse.Node.PLUGIN_TYPE,pulse.Node.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);pulse.plugins.invoke(pulse.Node.PLUGIN_TYPE,
pulse.Node.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)}});pulse.Node.nodeIdx=0;pulse.Node.PLUGIN_TYPE="pulse.Node";pulse.Node.PLUGIN_UPDATE="update";pulse=pulse||{};
pulse.RendererInterface=function(){function a(a){g.hasOwnProperty(a)||(g[a]={active:{},all:{}})}var b=this,e,g={sceneId:{active:{},all:{}}};this.implement=function(a){e=a;return b};this.clearLayer=function(b,i){a(i);return e.clearLayer(g[i].all[b].pulseLayerObj)};this.clearLayerSection=function(a,b,h,d,k,o){return e.clearLayerSection(a,b,h,d,g[o].active[k]&&g[o].active[k].rendererLayerObj)};this.getLiveLayerByName=function(b,e){a(e);return g[e].active[b]&&g[e].active[b].pulseLayerObj||null};this.addLayer=
function(b,i,h,d){a(d);g[d].all[b.name]={pulseLayerObj:b,rendererLayerObj:e.addLayer({isActive:h,containerElement:i,layerHeight:b.size.height,layerWidth:b.size.width,layerX:b.position.x,layerY:b.position.y,name:b.name,zIndex:b.zindex,visuals:{}})};h&&(g[d].active[b.name]=g[d].all[b.name])};this.removeLayer=function(b,i){a(i);e.removeLayer(g[i].all[b].rendererLayerObj);delete g[i].all[b];delete g[i].active[b]};this.prepareLayers=function(b,i,h){a(h);g[h].active={};var d=[],k;for(k in g[h].all)if(g[h].all.hasOwnProperty(k)){if(g[h].all[k].pulseLayerObj.size.width<
1)g[h].all[k].pulseLayerObj.size.width=b,g[h].all[k].rendererLayerObj.layerWidth=b;if(g[h].all[k].pulseLayerObj.size.height<1)g[h].all[k].pulseLayerObj.size.height=i,g[h].all[k].rendererLayerObj.layerHeight=i;g[h].all[k].rendererLayerObj.isActive&&(g[h].active[k]=g[h].all[k]);d.push(g[h].all[k].rendererLayerObj)}e.updateMultipleLayers(d)};this.addVisualToLayer=function(a,b,h){var d=g[h].all[b];d.rendererLayerObj.visuals[a.name]={pulseVisualObj:a,rendererVisualObj:e.addVisualToLayer({positionPrevious:a.positionPrevious,
size:a.size,sizePrevious:a.sizePrevious,bounds:a.bounds,boundsPrevious:a.boundsPrevious,anchor:a.anchor,anchorPrevious:a.anchorPrevious,anchorRadius:a.anchorRadius,anchorAngle:a.anchorAngle,scale:a.scale,scalePrevious:a.scalePrevious,rotation:a.rotation,rotationPrevious:a.rotationPrevious,positionTopLeft:a.positionTopLeft,positionTopLeftPrevious:a.positionTopLeftPrevious,invalidProperties:a.invalidProperties,zindex:a.zindex,zindexPrevious:a.zindexPrevious,shuffled:a.shuffled,alpha:a.alpha,alphaPrevious:a.alphaPrevious,
shadow:{shadowEnabled:a.shadowEnabled,shadowEnabledPrevious:a.shadowEnabledPrevious,shadowOffsetX:a.shadowOffsetX,shadowOffsetY:a.shadowOffsetY,shadowBlur:a.shadowBlur,shadowColor:a.shadowColor},visible:a.visible,visiblePrevious:a.visiblePrevious,updated:a.updated,type:a.visualType||pulse._enum.VisualObjectType.VISUAL},d.rendererLayerObj)};g[h].active[b]&&(g[h].active[b]=g[h].all[b])};this.removeVisualFromLayer=function(a,b,h){b=g[h].all[b];e.removeVisualFromLayer(b.rendererLayerObj.visuals[a.name].rendererVisualObj,
b.rendererLayerObj);delete b.rendererLayerObj.visuals[a.name]};this.updateVisualInLayer=function(a,b,h){b=g[h].all[b];b.rendererLayerObj.visuals[a.name].pulseVisualObj=a;b.rendererLayerObj.visuals[a.name].rendererVisualObj.positionPrevious=a.positionPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.size=a.size;b.rendererLayerObj.visuals[a.name].rendererVisualObj.sizePrevious=a.sizePrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.bounds=a.bounds;b.rendererLayerObj.visuals[a.name].rendererVisualObj.boundsPrevious=
a.boundsPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.anchor=a.anchor;b.rendererLayerObj.visuals[a.name].rendererVisualObj.anchorPrevious=a.anchorPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.anchorRadius=a.anchorRadius;b.rendererLayerObj.visuals[a.name].rendererVisualObj.anchorAngle=a.anchorAngle;b.rendererLayerObj.visuals[a.name].rendererVisualObj.scale=a.scale;b.rendererLayerObj.visuals[a.name].rendererVisualObj.scalePrevious=a.scalePrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.rotation=
a.rotation;b.rendererLayerObj.visuals[a.name].rendererVisualObj.rotationPrevious=a.rotationPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.positionTopLeft=a.positionTopLeft;b.rendererLayerObj.visuals[a.name].rendererVisualObj.positionTopLeftPrevious=a.positionTopLeftPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.invalidProperties=a.invalidProperties;b.rendererLayerObj.visuals[a.name].rendererVisualObj.zindex=a.zindex;b.rendererLayerObj.visuals[a.name].rendererVisualObj.zindexPrevious=
a.zindexPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.shuffled=a.shuffled;b.rendererLayerObj.visuals[a.name].rendererVisualObj.alpha=a.alpha;b.rendererLayerObj.visuals[a.name].rendererVisualObj.alphaPrevious=a.alphaPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.shadow.shadowEnabled=a.shadowEnabled;b.rendererLayerObj.visuals[a.name].rendererVisualObj.shadow.shadowEnabledPrevious=a.shadowEnabledPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.shadow.shadowOffsetX=
a.shadowOffsetX;b.rendererLayerObj.visuals[a.name].rendererVisualObj.shadow.shadowOffsetY=a.shadowOffsetY;b.rendererLayerObj.visuals[a.name].rendererVisualObj.shadow.shadowBlur=a.shadowBlur;b.rendererLayerObj.visuals[a.name].rendererVisualObj.shadow.shadowColor=a.shadowColor;b.rendererLayerObj.visuals[a.name].rendererVisualObj.visible=a.visible;b.rendererLayerObj.visuals[a.name].rendererVisualObj.visiblePrevious=a.visiblePrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.updated=a.updated;
b.rendererLayerObj.visuals[a.name].rendererVisualObj.visualType=a.visualType;b.rendererLayerObj.visuals[a.name].rendererVisualObj.textureFrame=a.textureFrame;b.rendererLayerObj.visuals[a.name].rendererVisualObj.textureFramePrevious=a.textureFramePrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.texture=a.texture;b.rendererLayerObj.visuals[a.name].rendererVisualObj.texturePrevious=a.texturePrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.textureUpdated=a.textureUpdated;b.rendererLayerObj.visuals[a.name].rendererVisualObj.fontSizePrevious=
a.fontSizePrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.fontSize=a.fontSize;b.rendererLayerObj.visuals[a.name].rendererVisualObj.font=a.font;b.rendererLayerObj.visuals[a.name].rendererVisualObj.fontPrevious=a.fontPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.fillColorPrevious=a.fillColorPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.fillColor=a.fillColor;b.rendererLayerObj.visuals[a.name].rendererVisualObj.textPrevious=a.textPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.text=
a.text;b.rendererLayerObj.visuals[a.name].rendererVisualObj.strokeWidthPrevious=a.strokeWidthPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.strokeWidth=a.strokeWidth;b.rendererLayerObj.visuals[a.name].rendererVisualObj.strokeColorPrevious=a.strokeColorPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.strokeColor=a.strokeColor;b.rendererLayerObj.visuals[a.name].rendererVisualObj.italicPrevious=a.italicPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.italic=a.italic;
b.rendererLayerObj.visuals[a.name].rendererVisualObj.boldPrevious=a.boldPrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.bold=a.bold;b.rendererLayerObj.visuals[a.name].rendererVisualObj.textBaselinePrevious=a.textBaselinePrevious;b.rendererLayerObj.visuals[a.name].rendererVisualObj.textBaseline=a.textBaseline;b.rendererLayerObj.visuals[a.name].rendererVisualObj.verts=a._private.verts;return e.updateVisual(b.rendererLayerObj.visuals[a.name].rendererVisualObj,b.rendererLayerObj)};this.drawVisualObject=
function(a,b,h){b=g[h].all[b];switch(a.visualType){case pulse._enum.VisualObjectType.VISUAL:e.drawPlainVisualObject(b.rendererLayerObj.visuals[a.name].rendererVisualObj,b.rendererLayerObj);break;case pulse._enum.VisualObjectType.SPRITE:b.rendererLayerObj.visuals[a.name].rendererVisualObj.imageCanvasToBeDrawn=this.getCurrentFrame();e.drawSpriteVisualObject(b.rendererLayerObj.visuals[a.name].rendererVisualObj,b.rendererLayerObj);break;case pulse._enum.VisualObjectType.BITMAP_LABEL:e.drawCanvasLabelVisualObject(b.rendererLayerObj.visuals[a.name].rendererVisualObj,
b.rendererLayerObj);break;case pulse._enum.VisualObjectType.CANVAS_LABEL:e.drawBitmapLabelVisualObject(b.rendererLayerObj.visuals[a.name].rendererVisualObj,b.rendererLayerObj)}}};pulse=pulse||{};pulse.PixiRenderer=function(){};pulse=pulse||{};
pulse.PulseDefaultRenderer=function(){function a(a){var b=[],f;for(f in a)a.hasOwnProperty(f)&&(a[f].containerElement.removeChild(a[f].canvas),b.push(a[f]));var b=b.sort(function(a,b){return a.zIndex-b.zIndex}),i;for(i in b)b.hasOwnProperty(i)&&b[i].isActive&&b[i].containerElement.appendChild(b[i].canvas)}var b=this;this.clearLayer=function(a){a.context.clearRect(0,0,a.canvas.width,a.canvas.height)};this.addLayer=function(a){var b=document.createElement("canvas");b.width=a.layerWidth;b.height=a.layerHeight;
b.style.position="absolute";b.id="live:"+a.name;a.canvas=b;a.context=a.canvas.getContext("2d");return a};this.removeLayer=function(a){a.containerElement.removeChild(a.canvas)};this.updateMultipleLayers=function(b){a(b)};this.clearLayerSection=function(a,b,f,i,h){return h.context.clearRect(a,b,f,i)};this.addVisualToLayer=function(a){a.canvas=document.createElement("canvas");a.context=this.canvas.getContext("2d");return a};this.removeVisualFromLayer=function(a,g){var f=a.boundsPrevious;return b.clearLayerSection(f.x,
f.y,f.width,f.height,g)};this.updateVisual=function(a){if(a.canvas.width!==a.size.width)a.canvas.width=a.size.width;if(a.canvas.height!==a.size.height)a.canvas.height=a.size.height};this.drawPlainVisualObject=function(a,b){var f=b.context;if(!(a.canvas.width===0||a.canvas.height===0)){f.save();f.globalAlpha=a.alpha/100;if(a.rotation!==0){var i=a.positionTopLeft.x+a.size.width*Math.abs(a.scale.x)/2,h=a.positionTopLeft.y+a.size.height*Math.abs(a.scale.y)/2;f.translate(i,h);f.rotate(Math.PI*(a.rotation%
360)/180);f.translate(-i,-h)}f.scale(a.scale.x,a.scale.y);i=a.positionTopLeft.x/a.scale.x;a.scale.x<1&&(i-=a.size.width);h=a.positionTopLeft.y/a.scale.y;a.scale.y<1&&(h-=a.size.height);if(a.shadowEnabled)f.shadowOffsetX=a.shadowOffsetX,f.shadowOffsetY=a.shadowOffsetY,f.shadowBlur=a.shadowBlur,f.shadowColor=a.shadowColor;f.drawImage(a.canvas,i,h);f.restore()}};this.drawSpriteVisualObject=function(a,b){var f=b.context;f.clearRect(0,0,a.canvas.width,a.canvas.height);f.drawImage(a.imageCanvasToBeDrawn,
0,0,a.size.width,a.size.height)};this.drawCanvasLabelVisualObject=function(a,b){var f=b.context;if(!(a.size.width===0||a.size.height===0)){f.clearRect(0,0,a.canvas.width,a.canvas.height);f.textBaseline=a.textBaseline;var i=a.fontSize+"px "+a.font;a.bold&&(i="bold "+i);a.italic&&(i="italic "+i);f.font=i;if(a.fillColor!="transparent")f.fillStyle=a.fillColor,f.fillText(a.text,0,a.size.height/2);if(a.strokeColor!="transparent"&&a.strokeWidth!==0)f.lineWidth=a.strokeWidth,f.strokeStyle=a.strokeColor,f.strokeText(a.text,
0,a.size.height/2)}};this.drawBitmapLabelVisualObject=function(a,b){var f=b.context;f.clearRect(0,0,a.canvas.width,a.canvas.height);for(var i=null,h=0,d=0;d<a.verts.length;d++)i=a.verts[d],i.size.width!==0&&i.size.height!==0&&f.drawImage(a.font.image,i.position.x,i.position.y,i.size.width,i.size.height,h+i.offset.x,i.offset.y,i.size.width,i.size.height),h+=i.xAdvance}};pulse=pulse||{};pulse._enum=pulse._enum||{};pulse._enum.VisualObjectType={VISUAL:"VISUAL",SPRITE:"SPRITE",BITMAP_LABEL:"BITMAP LABEL",CANVAS_LABEL:"CANVAS LABEL"};pulse=pulse||{};pulse.Asset=pulse.Node.extend({init:function(a){this._super(a);a=pulse.util.checkParams(a,{filename:"",autoLoad:true});this.filename=a.filename;this.autoLoad=a.autoLoad;this.percentLoaded=0;this.events=new pulse.EventManager;this.error=false;this._private={}},load:function(){},complete:function(){this.events.raiseEvent("complete",{asset:this})}});pulse=pulse||{};pulse.TextFile=pulse.Asset.extend({init:function(a){this._super(a);this.text="";this.autoLoad&&this.load()},load:function(){var a=this,b=new XMLHttpRequest;b.open("GET",this.filename,true);b.onreadystatechange=function(){if(b.readyState===4&&b.status===200)a.text=b.responseText,a.percentLoaded=100,a.complete()};b.send(null)}});pulse=pulse||{};
pulse.Texture=pulse.Asset.extend({init:function(a){this._super(a);a.filename===""&&pulse.error.InvalidSource();this._private.image=new Image;this._private.imgCanvas=document.createElement("canvas");if(this.autoLoad===true)this._private.image.src=this.filename;this.scaleY=this.scaleX=1;this.rotation=0;this.alpha=100;this._private.lastSlice=null;var b=this;this._private.image.onload=function(){b.percentLoaded=100;b.complete();b._private.lastSlice={x:-1,y:-1,width:b._private.image.width*b.scaleX,height:b._private.image.height*
b.scaleY,rotation:b.rotation,alpha:b.alpha}};this._private.image.onerror=function(){b.error=true}},load:function(){if(this.autoLoad!==true)this._private.image.src=this.filename},width:function(){return this._private.image.width*this.scaleX},height:function(){return this._private.image.height*this.scaleY},slice:function(a,b,e,g){if(this.percentLoaded!==100)return null;if(a===this._private.lastSlice.x&&b===this._private.lastSlice.y&&e===this._private.lastSlice.width&&g===this._private.lastSlice.height&&
this.rotation===this._private.lastSlice.rotation&&this.alpha===this._private.lastSlice.alpha)return this._private.imgCanvas;this._private.lastSlice={x:a,y:b,width:e*this.scaleX,height:g*this.scaleY,rotation:this.rotation,alpha:this.alpha};if(a===null||a<0)a=0;if(a>this._private.image.width)a=this._private.image.width;if(b===null||b<0)b=0;b>this._private.image.height&&(b=g);if(e===null||e>this._private.image.width)e=this._private.image.width;a+e>this._private.image.width&&(e=this._private.image.width-
a);if(g===null||g>this._private.image.height)g=this._private.image.height;b+g>this._private.image.height&&(g=this._private.image.height-b);var f=e*this.scaleX,i=g*this.scaleY,h=f,d=i;this.rotation%360!==0&&(h=f*Math.abs(Math.cos(Math.PI*this.rotation/180))+i*Math.abs(Math.sin(Math.PI*this.rotation/180)),d=i*Math.abs(Math.cos(Math.PI*this.rotation/180))+f*Math.abs(Math.sin(Math.PI*this.rotation/180)));this._private.imgCanvas.width=h;this._private.imgCanvas.height=d;var k=this._private.imgCanvas.getContext("2d");
k.save();var o=0,j=0;this.rotation%360!==0&&(o=(h-f)/2,j=(d-i)/2,h/=2,d/=2,k.translate(h,d),k.rotate(Math.PI*(this.rotation%360)/180),k.translate(-h,-d));k.globalAlpha=this.alpha/100;k.drawImage(this._private.image,a,b,e,g,o,j,f,i);if(pulse.DEBUG)k.save(),k.fillStyle="#42CCDE",k.beginPath(),k.arc(this._private.imgCanvas.width/2,this._private.imgCanvas.height/2,3,0,Math.PI*2,true),k.closePath(),k.fill(),k.restore();if(pulse.DEBUG)k.strokeStyle="#FF2200",k.strokeRect(o,j,f,i);k.restore();return this._private.imgCanvas}});pulse=pulse||{};pulse.BitmapChar=PClass.extend({init:function(){this.position={x:0,y:0};this.size={width:0,height:0};this.offset={x:0,y:0};this.page=this.xAdvance=0}});
pulse.BitmapFont=pulse.Asset.extend({init:function(a){this._super(a);this.fileDirectory=this.imageFilename="";this.image=null;this.base=this.lineHeight=0;this.size={width:0,height:0};this.characters={};a=window.location.href;a.indexOf("?")!==-1&&(a=a.substr(0,a.indexOf("?")));var a=a.split("/"),b=this.filename.split("/");a.pop();b.pop();this.fileDirectory=a.join("/");b.length>0&&(this.fileDirectory+="/"+b.join("/"));this.autoLoad&&this.load()},load:function(){var a=this,b=new XMLHttpRequest;b.open("GET",
this.filename,true);b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){var e=b.responseText.split("\n");a.percentLoaded=50;a.parse(e)}};b.send(null)},parse:function(a){for(var b,e=0;e<a.length;e++)if(b=a[e],b.indexOf("common")===0){var g=b.split(" ");for(b=0;b<g.length;b++){var f=g[b].split("=");if(f.length>1)switch(f[0]){case "lineHeight":this.lineHeight=parseInt(f[1],10);break;case "base":this.base=parseInt(f[1],10);break;case "scaleW":this.size.width=parseInt(f[1],10);break;case "scaleH":this.size.height=
parseInt(f[1],10)}}}else if(b.indexOf("page")===0){g=b.split(" ");for(b=0;b<g.length;b++)if(f=g[b].split("="),f.length>1&&f[0]==="file")this.imageFilename=f[1].replace(/"/gi,"")}else if(b.indexOf("char")===0){g=new pulse.BitmapChar;b=b.split(" ");for(f=0;f<b.length;f++){var i=b[f].split("=");if(i.length>1)switch(i[0]){case "id":this.characters[i[1]]=g;break;case "x":g.position.x=parseInt(i[1],10);break;case "y":g.position.y=parseInt(i[1],10);break;case "width":g.size.width=parseInt(i[1],10);break;
case "height":g.size.height=parseInt(i[1],10);break;case "xoffset":g.offset.x=parseInt(i[1],10);break;case "yoffset":g.offset.y=parseInt(i[1],10);break;case "xadvance":g.xAdvance=parseInt(i[1],10);break;case "page":g.page=parseInt(i[1],10)}}}var h=this;this.image=new Image;this.image.src=this.fileDirectory+"/"+this.imageFilename;this.image.onload=function(){h.percentLoaded=100;h.complete()}},getStringBitmapChars:function(a){for(var b=[],e=0,g=0;g<a.length;g++)e=a.charCodeAt(g),b.push(this.characters[e]);
return b},getStringWidth:function(a){for(var b=0,e=0,e=null,g=0;g<a.length;g++)e=a.charCodeAt(g),e=this.characters[e],b+=e.xAdvance;return b}});pulse=pulse||{};
pulse.Sound=pulse.Asset.extend({init:function(a){this._super(a);a=pulse.util.checkParams(a,{type:"flash",loop:false});this._private.type=a.type;this._private.type=="flash"&&this.initFlashPlayer();this._private.audio=null;this.loop=a.loop;this.paused=this.playing=false;this.autoLoad&&(this._private.type=="html5"||this._private.type=="flash"&&pulse.Sound.FlashReady)&&this.load()},load:function(){var a=this;switch(this._private.type){case "flash":this._private.audio=soundManager.createSound({id:"mySound",url:this.filename,
autoLoad:true,autoPlay:false,whileloading:function(){a.percentLoaded=this.bytesLoaded/this.bytesTotal*100},onload:function(){a.percentLoaded=100;a.complete()},onfinish:function(){a.finished()}});break;case "html5":var b=document.createElement("audio");b.canPlayType?(b.setAttribute("preload","auto"),b.canPlayType&&""!==b.canPlayType("audio/mpeg")?b.setAttribute("src",this.filename+".mp3"):b.canPlayType&&""!==b.canPlayType('audio/ogg; codecs="vorbis"')&&b.setAttribute("src",this.filename+".ogg"),b.addEventListener("progress",
function(){a.percentLoaded=b.buffered.end.length>0?b.buffered.end(0)/b.duration*100:0;a.percentLoaded>=100&&a.complete()}),b.addEventListener("ended",function(){a.finished()})):b=null;this._private.audio=b}},play:function(){if(this._private.audio){switch(this._private.type){case "flash":this.paused?this._private.audio.resume():this._private.audio.play();break;case "html5":this.loop&&this._private.audio.setAttribute("loop","loop"),this._private.audio.play()}this.playing=true;this.paused=false}},pause:function(){if(this._private.audio){switch(this._private.type){case "flash":case "html5":this._private.audio.pause()}this.playing=
false;this.paused=true}},stop:function(){if(this._private.audio)switch(this.paused=this.playing=false,this._private.type){case "flash":this._private.audio.stop();break;case "html5":this._private.audio.pause(),this._private.audio.currentTime=0}},finished:function(){switch(this._private.type){case "flash":this.loop&&this.start()}this.events.raiseEvent("finished",{sound:this})},initFlashPlayer:function(){if(pulse.Sound.FlashInitialized===false)pulse.Sound.FlashInitialized=true,window.soundManager=new SoundManager(pulse.libsrc+
"/asset/"),soundManager.beginDelayedInit(),soundManager.flashVersion=8,soundManager.useFlashBlock=false,soundManager.onready(function(){pulse.Sound.FlashReady=true;this.autoLoad&&this.load()},this),soundManager.ontimeout(function(){});else if(pulse.Sound.FlashReady===false)soundManager.onready(function(){this.autoLoad&&this.load()},this)}});pulse.Sound.FlashInitialized=false;pulse.Sound.FlashReady=false;pulse=pulse||{};
pulse.AssetBundle=PClass.extend({init:function(){this.assets=[];this.events=new pulse.EventManager;this._private={};this.percentLoaded=this._private.numberLoaded=0},addAsset:function(a){if(a instanceof pulse.Asset){var b=this;a.events.bind("complete",function(){b._private.numberLoaded++;b.updatePercent();b.events.raiseEvent("assetLoaded",{asset:a.name})});this.assets.push(a)}},removeAsset:function(a){var b=a;if(a instanceof pulse.Asset)b=a.name;for(var e in this.assets)this.assets[e].name===b&&this.assets.splice(e,
1);this.updatePercent()},getAsset:function(a){for(var b=0;b<this.assets.length;b++)if(this.assets[b].name===a)return this.assets[b];return null},load:function(){for(var a=0;a<this.assets.length;a++)this.assets[a].load()},updatePercent:function(){this.assets.length===0?this.percentLoaded=100:(this.percentLoaded=this._private.numberLoaded/this.assets.length*100,this.percentLoaded=parseFloat(this.percentLoaded.toFixed(2)));this.events.raiseEvent("progressChanged",{});this.percentLoaded===100&&this.events.raiseEvent("complete",
{})}});pulse=pulse||{};
pulse.AssetManager=PClass.extend({init:function(){this.bundles={};this.addBundle(new pulse.AssetBundle,"global");this.bundles.global.percentLoaded=100;this._private={};this._private.bundlesLoaded=1;this.percentLoaded=0;this.events=new pulse.EventManager},addBundle:function(a,b){if(a instanceof pulse.AssetBundle&&!this.bundles.hasOwnProperty(b)){var e=this;a.events.bind("progressChanged",function(){e.updatePercent()});a.events.bind("assetLoaded",function(a){e.events.raiseEvent("assetLoaded",a)});this.bundles[b]=
a}},addAsset:function(a,b){a instanceof pulse.Asset&&(typeof b==="string"?(this.bundles.hasOwnProperty(b)||this.addBundle(new pulse.AssetBundle,b),this.bundles[b].addAsset(a),this.bundles[b].percentLoaded===100&&this.loadedBundles--):(this.bundles.global.addAsset(a),this.bundles.global.percentLoaded===100&&(this.bundles.global.updatePercent(),this.loadedBundles--)))},removeAsset:function(a,b){typeof b==="string"?this.bundles.hasOwnProperty(b)&&this.bundles[b].removeAsset(a):this.bundles.global.removeAsset(a)},
getAsset:function(a,b){if(b){if(this.bundles.hasOwnProperty(b))return this.bundles[b].getAsset(a)}else return this.bundles.global.getAsset(a)},load:function(){for(var a in this.bundles)this.bundles[a].load()},updatePercent:function(){var a=pulse.util.getLength(this.bundles)*100,b=0,e;for(e in this.bundles)b+=this.bundles[e].percentLoaded;this.percentLoaded=b/a*100;this.percentLoaded=parseFloat(this.percentLoaded.toFixed(2));this.events.raiseEvent("progressChanged",{});this.percentLoaded===100&&this.events.raiseEvent("complete",
{})}});pulse=pulse||{};
pulse.Visual=pulse.Node.extend({init:function(a){pulse.plugins.invoke("pulse.Visual","init",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);this._super(a);this._private.firstUpdate=true;this.position={x:0,y:0};this.positionPrevious={x:0,y:0};this.size={width:0,height:0};this.sizePrevious={width:0,height:0};this.bounds={x:0,y:0,width:0,height:0};this.boundsPrevious={x:0,y:0,width:0,height:0};this.anchor={x:0.5,y:0.5};this.anchorPrevious={x:0.5,y:0.5};this.anchorAngle=this.anchorRadius=0;this.scale=
{x:1,y:1};this.scalePrevious={x:1,y:1};this.rotationPrevious=this.rotation=0;this.positionTopLeft={x:0,y:0};this.positionTopLeftPrevious={x:0,y:0};this.invalidProperties=true;this.zindex=Number.NaN;this.zindexPrevious=0;this.shuffled=false;this.alphaPrevious=this.alpha=100;this.shadowEnabledPrevious=this.shadowEnabled=false;this.shadowBlur=this.shadowOffsetY=this.shadowOffsetX=2;this.shadowColor="rgba(0, 0, 0, 0.5)";this.visiblePrevious=this.visible=true;this.actions={};this.runningActions={};this.updated=
true;this.events=new pulse.EventManager({owner:this,masterCallback:this.eventsCallback});this.mousein=false;this.visualType=pulse._enum.VisualObjectType.VISUAL;pulse.plugins.invoke("pulse.Visual","init",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},move:function(a,b){this.position.x+=a;this.position.y+=b},getAction:function(a){return this.actions[a]},runAction:function(a,b){var b=b||null,e=this.getAction(a);e.target=this;e.start(b);return e},addAction:function(a){a.target=this;this.actions[a.name]=
a},update:function(a){pulse.plugins.invoke(pulse.Visual.PLUGIN_TYPE,pulse.Visual.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);this._super(a);for(var b in this.runningActions)this.runningActions[b].update(a);if(this._private.firstUpdate)this._private.firstUpdate=false,this.invalidProperties=true;if(this.position.x!==this.positionPrevious.x||this.position.y!==this.positionPrevious.y)this.positionPrevious.x=this.position.x,this.positionPrevious.y=this.position.y,this.invalidProperties=
true;if(this.size.width!==this.sizePrevious.width||this.size.height!==this.sizePrevious.height)this.sizePrevious.width=this.size.width,this.sizePrevious.height=this.size.height,this.invalidProperties=true;if(this.anchor.x!==this.anchorPrevious.x||this.anchor.y!==this.anchorPrevious.y)this.anchorPrevious.x=this.anchor.x,this.anchorPrevious.y=this.anchor.y,this.invalidProperties=true;if(this.scale.x!==this.scalePrevious.x||this.scale.y!==this.scalePrevious.y)this.scalePrevious.x=this.scale.x,this.scalePrevious.y=
this.scale.y,this.invalidProperties=true;if(this.rotation!==this.rotationPrevious)this.rotationPrevious=this.rotation,this.invalidProperties=true;if(this.zindex!==this.zindexPrevious)this.zindexPrevious=this.zindex,this.updated=this.shuffled=true;if(this.alpha!==this.alphaPrevious)this.alphaPrevious=this.alpha,this.updated=true;if(this.visible!==this.visiblePrevious)this.visiblePrevious=this.visible,this.updated=true;if(this.shadowEnabled!==this.shadowEnabledPrevious)this.shadowEnabledPrevious=this.shadowEnabled,
this.updated=true;if(this.invalidProperties)this.calculateProperties(),this.updated=true;pulse.renderer.updateVisualInLayer(this,this.parent.name,this.parent.parent.sceneId);pulse.plugins.invoke(pulse.Visual.PLUGIN_TYPE,pulse.Visual.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},draw:function(a){pulse.plugins.invoke(pulse.Visual.PLUGIN_TYPE,pulse.Visual.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);pulse.renderer.drawVisualObject(this,this.parent.name,
this.parent.parent.sceneId);this.updated=false;pulse.plugins.invoke(pulse.Visual.PLUGIN_TYPE,pulse.Visual.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},calculateProperties:function(){var a=this.size.width,b=this.size.height,a=this.anchor.x*a-a/2,b=this.anchor.y*b-b/2;this.anchorRadius=Math.sqrt(a*a+b*b);this.anchorAngle=Math.atan2(b,a)*180/Math.PI-90;if(isNaN(this.anchorAngle))this.anchorAngle=0;this.positionTopLeftPrevious=this.positionTopLeft;a=this.size.width*Math.abs(this.scale.x)/
2;b=this.size.height*Math.abs(this.scale.y)/2;a=this.position.x-Math.sin(Math.PI*-(this.rotation+this.anchorAngle)/180)*this.anchorRadius-a;b=this.position.y-Math.cos(Math.PI*-(this.rotation+this.anchorAngle)/180)*this.anchorRadius-b;this.positionTopLeft={x:a,y:b};this.boundsPrevious=this.bounds;this.bounds={x:this.positionTopLeft.x,y:this.positionTopLeft.y,width:this.size.width*Math.abs(this.scale.x),height:this.size.height*Math.abs(this.scale.y)};this.invalidProperties=false},on:function(a,b){this.events.bind(a,
b)},eventsCallback:function(){}});pulse.Visual.PLUGIN_TYPE="pulse.Visual";pulse.Visual.PLUGIN_DRAW="draw";pulse.Visual.PLUGIN_UPDATE="update";pulse=pulse||{};
pulse.Action=pulse.Node.extend({init:function(a){this._super(a);if(a.target==="")throw"Target must be included for action.";this.target=a.target;this.isComplete=this.isPaused=this.isRunning=false;this.events=new pulse.EventManager},start:function(){pulse.DEBUG&&console.log("action started");this.target.runningActions&&(this.target.runningActions[this.name]=this);this.isComplete=false;this.isRunning=true;this.isPaused=false},pause:function(){pulse.DEBUG&&console.log("action paused");this.isRunning=
false;this.isPaused=true},stop:function(){pulse.DEBUG&&console.log("action stopped");this.target.runningActions&&delete this.target.runningActions[this.name];this.isPaused=this.isRunning=false},complete:function(){pulse.DEBUG&&console.log("action complete");this.target.runningActions&&delete this.target.runningActions[this.name];this.isRunning=false;this.isComplete=true;this.events.raiseEvent("complete",{action:this})}});pulse=pulse||{};
pulse.AnimateAction=pulse.Action.extend({init:function(a){this._super(a);a=pulse.util.checkParams(a,{name:this.name,size:{width:0,height:0},frames:0,frameRate:0,offset:{x:0,y:0},bounds:{width:1,height:1},plays:-1});this.size=a.size;this._private.frameOriginal={x:0,y:0,width:0,height:0};this._private.bounds=a.bounds;this._private.frames=a.frames;this._private.frameRate=a.frameRate;this._private.offset=a.offset;this._private.plays=a.plays;this._private.currentPlay=1;this._private.currentFrame=0;this._private.start=
0;this._private.playTime=0},bounds:function(a){if(typeof a==="undefined"||a===null)return this._private.bounds;if(a.width<=0)a.width=1;if(a.height<=0)a.height=1;this._private.bounds=a},getFrame:function(a){a=pulse.util.checkValue(a,this._private.currentFrame);this._private.frames instanceof Array&&(a=this._private.frames[this._private.currentFrame]);for(var a=(a+this._private.offset.x)*this.size.width,b=this._private.offset.y;a>=this._private.bounds.width;)a-=this._private.bounds.width,b++;b*=this.size.height;
b>=this._private.bounds.height&&(b=this._private.bounds.height-this.size.height);return{x:a,y:b,width:this.size.width,height:this.size.height}},start:function(a){this._super();this._private.currentPlay=1;this._private.playTime=1/this._private.frameRate*1E3;this._private.frameOriginal=a?a:null},pause:function(){this._super()},stop:function(){this._super();this._private.currentFrame=0;this._private.playTime=0;if(this._private.frameOriginal)this.target.textureFrame=this._private.frameOriginal,this.target.updated=
true},complete:function(){this._super();if(this._private.frameOriginal)this.target.textureFrame=this._private.frameOriginal,this.target.updated=true},update:function(a){this._super();if(this.running!==false){var b=false;this._private.playTime+=a;if(this._private.playTime>=1/this._private.frameRate*1E3){this._private.currentFrame++;if(this._private.currentFrame>=(this._private.frames.length||this._private.frames))if(this._private.currentFrame=0,this._private.currentPlay++,this._private.plays>0&&this._private.currentPlay>
this._private.plays){this.stop();this.complete();return}this._private.playTime=0;b=true}if(b)this.target.textureFrame=this.getFrame(),this.target.updated=true}}});pulse=pulse||{};
pulse.MoveAction=pulse.Action.extend({init:function(a){this._super(a);a=pulse.util.checkParams(a,{name:this.name,position:null,duration:0,easing:pulse.util.easeInOutQuad});this.position=a.position;this.duration=a.duration;this.easingFunction=a.easing;this._private.playTime=0;this._private.startPosition=null;this._private.positionDiff=null},start:function(){this._super();if(this.target&&!this.isPaused)this._private.playTime=0,this._private.startPosition={x:this.target.position.x,y:this.target.position.y},this._private.positionDiff=
{x:this.position.x-this._private.startPosition.x,y:this.position.y-this._private.startPosition.y}},pause:function(){this._super()},stop:function(){this._super()},complete:function(){this._super()},update:function(a){this._super();if(this.running!==false){this._private.playTime+=a;a={};if(this._private.playTime>this.duration)this._private.playTime=this.duration,this.stop(),this.complete();a={x:this.easingFunction(this._private.playTime,this._private.startPosition.x,this._private.positionDiff.x,this.duration),
y:this.easingFunction(this._private.playTime,this._private.startPosition.y,this._private.positionDiff.y,this.duration)};this.target.position=a}}});pulse=pulse||{};
pulse.Sprite=pulse.Visual.extend({init:function(a){pulse.plugins.invoke("pulse.Sprite","init",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);this._super(a);this.texturePrevious=this.texture=null;this.textureFrame={x:0,y:0,width:0,height:0};this.textureFramePrevious={x:0,y:0,width:0,height:0};this.textureUpdated=true;a=pulse.util.checkParams(a,{src:"",size:{}});this.size=a.size;this.texture=typeof a.src==="object"?a.src:new pulse.Texture({filename:a.src});this._private.isDragging=false;this._private.dragPos=
false;this.hitTestType=pulse.Sprite.HIT_TEST_RECT;this.hitTestPoints=null;this.dropAcceptEnabled=this.dragMoveEnabled=this.dragDropEnabled=false;this.draggedOverItems={};this.handleAllEvents=false;var b=this;this.itemDroppedCallback=function(a){a.target=b;b.events.raiseEvent("itemdropped",a)};this.visualType=pulse._enum.VisualObjectType.SPRITE;pulse.plugins.invoke("pulse.Sprite","init",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},loaded:function(){return this.texture.loaded()},addAction:function(a){a instanceof
pulse.Action?a.target=this:a=new pulse.AnimateAction({target:this,name:a.name,size:a.size,frames:a.frames,frameRate:a.frameRate,offset:a.offset});a.bounds({x:this.texture.width(),y:this.texture.height()});this.actions[a.name]=a},inCurrentBounds:function(a,b){a-=this.bounds.x;b-=this.bounds.y;if(this.rotation!==0)var e=this.size.width/2,g=this.size.height/2,f=a-e,i=b-g,h=Math.sqrt(f*f+i*i),f=Math.atan2(i,f)+Math.PI/2,a=h*Math.sin(f-this.rotation*Math.PI/180)+e,b=g-h*Math.cos(f-this.rotation*Math.PI/
180);if(this.hitTestType===pulse.Sprite.HIT_TEST_RECT)if(this.hitTestPoints&&this.hitTestPoints.length>0){if(a>=this.hitTestPoints[0].x&&a<=this.hitTestPoints[1].x&&b>=this.hitTestPoints[0].y&&b<=this.hitTestPoints[1].y)return true}else{if(a>=0&&a<=this.bounds.width&&b>=0&&b<=this.bounds.height)return true}else if(this.hitTestType===pulse.Sprite.HIT_TEST_CONVEX&&this.hitTestPoints&&this.hitTestPoints.length>=3){e=this.hitTestPoints.length;g=false;h={};i={};f=0;for(i=e-1;f<e;i=f++)h=this.hitTestPoints[f],
i=this.hitTestPoints[i],h.y>b!=i.y>b&&a<(i.x-h.x)*(b-h.y)/(i.y-h.y)+h.x&&(g=!g);return g}return false},getCurrentFrame:function(){if(!(this.texture.percentLoaded<100)){var a=this.texture.width();if(this.textureFrame.width!==0)a=this.textureFrame.width;var b=this.texture.height();if(this.textureFrame.height!==0)b=this.textureFrame.height;return this.texture.slice(this.textureFrame.x,this.textureFrame.y,a,b)}},update:function(a){pulse.plugins.invoke(pulse.Sprite.PLUGIN_TYPE,pulse.Sprite.PLUGIN_UPDATE,
pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);if(this.texture!==this.texturePrevious)this.texturePrevious=this.texture,this.updated=this.textureUpdated=true;if(this.texture.percentLoaded===100){if(this.size===null)this.size={};if(!this.size.width)this.size.width=this.texture.width();if(!this.size.height)this.size.height=this.texture.height()}if(this.textureFrame.x!==this.textureFramePrevious.x||this.textureFrame.y!==this.textureFramePrevious.y||this.textureFrame.width!==this.textureFramePrevious.width||
this.textureFrame.height!==this.textureFramePrevious.height)this.textureFramePrevious.x=this.textureFrame.x,this.textureFramePrevious.y=this.textureFrame.y,this.textureFramePrevious.width=this.textureFrame.width,this.textureFramePrevious.height=this.textureFrame.height,this.updated=this.textureUpdated=true;pulse.renderer.updateVisualInLayer(this,this.parent.name,this.parent.parent.sceneId);this._super(a);pulse.plugins.invoke(pulse.Sprite.PLUGIN_TYPE,pulse.Sprite.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onExit,
this,arguments)},draw:function(a){pulse.plugins.invoke(pulse.Sprite.PLUGIN_TYPE,pulse.Sprite.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);if(!(this.texture.percentLoaded<100||this.size.width===0||this.size.height===0)){if(this.textureUpdated)pulse.renderer.drawVisualObject(this,this.parent.name,this.parent.parent.sceneId),this.textureUpdated=false;this._super(a);pulse.plugins.invoke(pulse.Sprite.PLUGIN_TYPE,pulse.Sprite.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onExit,this,
arguments)}},calculateProperties:function(){this._super()},killDrag:function(a){if(this._private.isDragging)this.handleAllEvents=this._private.isDragging=false,a.sender=this,this.events.raiseEvent("dragdrop",a),delete pulse.EventManager.DraggedItems["sprite:"+this.name]},eventsCallback:function(a,b){if(a==="mousedown"&&this.dragDropEnabled)this._private.isDragging=true,this._private.dragPos={x:b.world.x,y:b.world.y},this.handleAllEvents=true,b.sender=this,this.events.raiseEvent("dragstart",b),pulse.EventManager.DraggedItems["sprite:"+
this.name]=this;if((a==="mousemove"||a==="mouseup")&&this._private.isDragging){var e=b.world.x-this._private.dragPos.x,g=b.world.y-this._private.dragPos.y;if(this.dragMoveEnabled)this.position={x:this.position.x+e,y:this.position.y+g};this._private.dragPos={x:b.world.x,y:b.world.y}}a==="mouseup"&&this.killDrag(b);if(a=="mousemove")this._private.mousein=true}});pulse.Sprite.HIT_TEST_RECT="rect";pulse.Sprite.HIT_TEST_CONVEX="convex";pulse.Sprite.PLUGIN_TYPE="pulse.Sprite";pulse.Sprite.PLUGIN_DRAW="draw";
pulse.Sprite.PLUGIN_UPDATE="update";pulse=pulse||{};
pulse.BitmapLabel=pulse.Visual.extend({init:function(a){pulse.plugins.invoke("pulse.BitmapLabel","init",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);this._super(a);a=pulse.util.checkParams(a,{font:"",text:""});this.fontPrevious=this.font=null;this.text=a.text;this.textPrevious="";this._private.verts=[];this.font=typeof a.font==="object"?a.font:new pulse.BitmapFont({filename:a.font});this.visualType=pulse._enum.VisualObjectType.BITMAP_LABEL;pulse.plugins.invoke("pulse.BitmapLabel","init",
pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},loaded:function(){return this.font.percentLoaded===100},update:function(a){pulse.plugins.invoke(pulse.BitmapLabel.PLUGIN_TYPE,pulse.BitmapLabel.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);if(this.text!==this.textPrevious&&this.loaded())this.textPrevious=this.text,this.size.height=this.font.lineHeight,this.size.width=this.font.getStringWidth(this.text),this._private.verts=this.font.getStringBitmapChars(this.text),this.updated=
true;if(this.font!==this.fontPrevious&&this.loaded())this.fontPrevious=this.font,this.updated=true;pulse.renderer.updateVisualInLayer(this,this.parent.name,this.parent.parent.sceneId);this._super(a);pulse.plugins.invoke(pulse.BitmapLabel.PLUGIN_TYPE,pulse.BitmapLabel.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},draw:function(a){pulse.plugins.invoke(pulse.BitmapLabel.PLUGIN_TYPE,pulse.BitmapLabel.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);if(this.loaded()&&
!(this.size.width===0||this.size.height===0))pulse.renderer.drawVisualObject(this,this.parent.name,this.parent.parent.sceneId),this._super(a),pulse.plugins.invoke(pulse.BitmapLabel.PLUGIN_TYPE,pulse.BitmapLabel.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)}});pulse.BitmapLabel.PLUGIN_TYPE="pulse.BitmalLabel";pulse.BitmapLabel.PLUGIN_DRAW="draw";pulse.BitmapLabel.PLUGIN_UPDATE="update";pulse=pulse||{};
pulse.CanvasLabel=pulse.Visual.extend({init:function(a){pulse.plugins.invoke("pulse.CanvasLabel","init",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);this._super(a);a=pulse.util.checkParams(a,{font:"sans-serif",fontSize:20,text:""});this.fontPrevious=this.font=a.font;this.fontSizePrevious=this.fontSize=a.fontSize;this.text=a.text;this.textPrevious="";this.strokeColorPrevious=this.strokeColor=this.fillColorPrevious=this.fillColor="#000000";this.strokeWidthPrevious=this.strokeWidth=0;this.italicPrevious=
this.italic=this.boldPrevious=this.bold=false;this.textBaselinePrevious=this.textBaseline="middle";this.visualType=pulse._enum.VisualObjectType.CANVAS_LABEL;pulse.plugins.invoke("pulse.CanvasLabel","init",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},loaded:function(){return this.font.percentLoaded===100},update:function(a){pulse.plugins.invoke(pulse.CanvasLabel.PLUGIN_TYPE,pulse.CanvasLabel.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);var b=false;if(this.font!=
this.fontPrevious)this.fontPrevious=this.font,b=true;if(this.fontSize!=this.fontSizePrevious)this.fontSizePrevious=this.fontSize,b=true;if(this.text!=this.textPrevious)this.textPrevious=this.text,b=true;if(this.fillColor!=this.fillColorPrevious)this.fillColorPrevious=this.fillColor,b=true;if(this.strokeColor!=this.strokeColorPrevious)this.strokeColorPrevious=this.strokeColor,b=true;if(this.strokeWidth!=this.strokeWidthPrevious)this.strokeWidthPrevious=this.strokeWidth,b=true;if(this.bold!=this.boldPrevious)this.boldPrevious=
this.bold,b=true;if(this.italic!=this.italicPrevious)this.italicPrevious=this.italic,b=true;if(this.textBaseline!=this.textBaselinePrevious)this.textBaselinePrevious=this.textBaseline,b=true;if(b){b=document.createElement("canvas").getContext("2d");b.textBaseline=this.textBaseline;var e=this.fontSize+"px "+this.font;this.bold&&(e="bold "+e);this.italic&&(e="italic "+e);b.font=e;if(this.fillColor!="transparent")b.fillStyle=this.fillColor,b.fillText(this.text,0,0);if(this.strokeColor!="transparent"&&
this.strokeWidth!==0)b.lineWidth=this.strokeWidth,b.strokeStyle=this.strokeColor,b.strokeText(this.text,0,0);b=b.measureText(this.text);this.size.height=this.fontSize+2;this.size.width=Math.ceil(b.width)+2;this.updated=true}pulse.renderer.updateVisualInLayer(this,this.parent.name,this.parent.parent.sceneId);this._super(a);pulse.plugins.invoke(pulse.CanvasLabel.PLUGIN_TYPE,pulse.CanvasLabel.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},draw:function(a){pulse.plugins.invoke(pulse.CanvasLabel.PLUGIN_TYPE,
pulse.CanvasLabel.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);pulse.renderer.drawVisualObject(this,this.parent.name,this.parent.parent.sceneId);this._super(a);pulse.plugins.invoke(pulse.CanvasLabel.PLUGIN_TYPE,pulse.CanvasLabel.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)}});pulse.CanvasLabel.PLUGIN_TYPE="pulse.BitmapLabel";pulse.CanvasLabel.PLUGIN_DRAW="draw";pulse.CanvasLabel.PLUGIN_UPDATE="update";pulse=pulse||{};
pulse.Layer=pulse.Visual.extend({init:function(a){pulse.plugins.invoke("pulse.Layer","init",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);this._super(a);a=pulse.util.checkParams(a,{x:0,y:0,size:{width:0,height:0}});this.position.x=a.x;this.position.y=a.y;this.size=a.size;this.objects={};this._private.orderedKeys=[];pulse.plugins.invoke("pulse.Layer","init",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},addNode:function(a){pulse.plugins.invoke("pulse.Layer","addNode",pulse.plugin.PluginCallbackTypes.onEnter,
this,arguments);if(a instanceof pulse.Visual){if(isNaN(a.zindex))a.zindex=this._private.orderedKeys.length+1;this.objects.hasOwnProperty(a.name)?pulse.error.DuplicateName(a.name):(this.objects[a.name]=a,a.parent=this,a.updated=true,this._private.orderedKeys=pulse.util.getOrderedKeys(this.objects),pulse.renderer.addVisualToLayer(a,this.name,this.parent.sceneId))}pulse.plugins.invoke("pulse.Layer","addNode",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},removeNode:function(a){pulse.plugins.invoke("pulse.Layer",
"removeNode",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);var b=a;if(a instanceof pulse.Visual)b=a.name;if(this.objects.hasOwnProperty(b))this.objects[b]instanceof pulse.Visual&&pulse.renderer.removeVisualFromLayer(this.objects[b],this.name,this.parent.sceneId),this.objects[b].parent=null,delete this.objects[b];pulse.plugins.invoke("pulse.Layer","removeNode",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},getNode:function(a){return this.objects[a]},getNodesByType:function(a){var b=
{},e;for(e in this.objects)this.objects.hasOwnProperty(e)&&this.objects[e]instanceof a&&(b[e]=this.objects[e]);return b},update:function(a){pulse.plugins.invoke(pulse.Layer.PLUGIN_TYPE,pulse.Layer.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);var b=false,e;for(e in this.objects)if(this.objects.hasOwnProperty(e)&&this.objects[e]instanceof pulse.Visual){if(this.objects[e].shuffled===true)this.objects[e].shuffled=false,b=true;this.objects[e].update(a);if(this.objects[e].updated)this.updated=
true}if(b)this._private.orderedKeys=pulse.util.getOrderedKeys(this.objects);this._super(a);pulse.plugins.invoke(pulse.Layer.PLUGIN_TYPE,pulse.Layer.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},draw:function(){pulse.plugins.invoke(pulse.Layer.PLUGIN_TYPE,pulse.Layer.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);var a=false,b;for(b in this.objects)if(this.objects.hasOwnProperty(b)&&this.objects[b].updated){a=true;break}if(a){for(a=this.parent;a!==null&&
!(a instanceof pulse.Engine);)a=a.parent;if(a===null)return;pulse.renderer.clearLayerSection(-this.positionTopLeft.x,-this.positionTopLeft.y,a.size.width,a.size.height,this.name,this.parent.sceneId);for(a=0;a<this._private.orderedKeys.length;a++)if(b=this.objects[this._private.orderedKeys[a]],b instanceof pulse.Visual)b.visible?b.draw():b.updated=false}this._super();pulse.plugins.invoke(pulse.Layer.PLUGIN_TYPE,pulse.Layer.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},pointInBounds:function(a){return a.x>
this.bounds.x&&a.x<this.bounds.x+this.bounds.width&&a.y>this.bounds.y&&a.y<this.bounds.y+this.bounds.height},eventsCallback:function(a,b){if(!(typeof b==="undefined"||typeof b.position==="undefined")){b.parent.x=b.position.x;b.parent.y=b.position.y;var e=this.getNodesByType(pulse.Sprite),g,f;for(f in e)if(e.hasOwnProperty(f)&&(g=e[f],g.visible))if(pulse.events[a]==="mouse"||pulse.events[a]==="touch"){var i=g.bounds;b.position.x=b.parent.x-i.x;b.position.y=b.parent.y-i.y;b.sender=g;if(g.handleAllEvents||
g.inCurrentBounds(b.parent.x,b.parent.y)){if(g.inCurrentBounds(b.parent.x,b.parent.y)&&g.mousein===false)g.mousein=true,g.events.raiseEvent("mouseover",b);g.events.raiseEvent(a,b)}if(!g.inCurrentBounds(b.parent.x,b.parent.y)&&g.mousein===true)g.mousein=false,g.events.raiseEvent("mouseout",b);if(g.dropAcceptEnabled)for(var h in pulse.EventManager.DraggedItems)if(pulse.EventManager.DraggedItems.hasOwnProperty(h))if(i=pulse.EventManager.DraggedItems[h],g.inCurrentBounds(b.parent.x,b.parent.y))b.target=
i,g.draggedOverItems[h]?(b.sender=g,g.events.raiseEvent("dragover",b)):(g.draggedOverItems[h]=i,i.events.bind("dragdrop",g.itemDroppedCallback),g.events.raiseEvent("dragenter",b));else if(g.draggedOverItems[h])delete g.draggedOverItems[h],b.target=i,i.events.unbindFunction("dragdrop",g.itemDroppedCallback),g.events.raiseEvent("dragexit",b)}else b.sender=g,g.events.raiseEvent(a,b)}}});pulse.Layer.PLUGIN_TYPE="pulse.Layer";pulse.Layer.PLUGIN_DRAW="draw";pulse.Layer.PLUGIN_UPDATE="update";pulse=pulse||{};
pulse.Scene=pulse.Node.extend({init:function(a){pulse.plugins.invoke("pulse.Scene","init",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);this._super(a);this.container=null;this.layers={};this._private.orderedKeys=[];this._private.defaultSize={width:0,height:0};this.active=false;this.sceneId="Scene_"+~~(Math.random()*1E7)+~~(Math.random()*Math.random()*9999999);this.events=new pulse.EventManager({owner:this,masterCallback:this.eventsCallback});pulse.plugins.invoke("pulse.Scene","init",pulse.plugin.PluginCallbackTypes.onExit,
this,arguments)},setDefaultSize:function(a,b){for(var e in this.layers){if(this.layers[e].size.width<1)this.layers[e].size.width=a;if(this.layers[e].size.height<1)this.layers[e].size.height=b}this._private.defaultSize={width:a,height:b}},addLayer:function(a,b){pulse.plugins.invoke("pulse.Scene","addLayer",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);if(a instanceof pulse.Layer&&!this.layers.hasOwnProperty(a.name)){if(typeof b==="number")a.zindex=b;if(isNaN(a.zindex))a.zindex=this._private.orderedKeys.length+
1;if(a.size.width<1)a.size.width=this._private.defaultSize.width;if(a.size.height<1)a.size.height=this._private.defaultSize.height;a.parent=this;this.layers[a.name]=a;this._private.orderedKeys=pulse.util.getOrderedKeys(this.layers);this.active===true&&(pulse.renderer.addLayer(a,this.container,true,this.sceneId),pulse.renderer.prepareLayers(this._private.defaultSize.width,this._private.defaultSize.height,this.sceneId))}pulse.plugins.invoke("pulse.Scene","addLayer",pulse.plugin.PluginCallbackTypes.onExit,
this,arguments)},removeLayer:function(a){pulse.plugins.invoke("pulse.Scene","removeLayer",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);typeof a==="string"&&this.layers.hasOwnProperty(a)&&(delete this.layers[a],pulse.renderer.removeLayer(a,this.sceneId));pulse.plugins.invoke("pulse.Scene","removeLayer",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},getLayer:function(a){return this.layers.hasOwnProperty(a)?this.layers[a]:null},getLiveLayer:function(a){return pulse.renderer.getLiveLayerByName(a,
this.sceneId)},updateLiveLayers:function(){pulse.renderer.prepareLayers(this._private.defaultSize.width,this._private.defaultSize.height,this.sceneId)},getSceneContainer:function(){if(!this.container)this.container=document.createElement("div"),this.container.style.position="absolute",this.container.id=this.name,this.updateLiveLayers();return this.container},update:function(a){pulse.plugins.invoke(pulse.Scene.PLUGIN_TYPE,pulse.Scene.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);
this._super(a);var b=false,e;for(e in this.layers)if(this.layers[e].shuffled===true)this.layers[e].shuffled=false,b=true;if(b===true)this._private.orderedKeys=pulse.util.getOrderedKeys(this.layers);for(var g in this.layers)this.layers[g].update(a);pulse.plugins.invoke(pulse.Scene.PLUGIN_TYPE,pulse.Scene.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},draw:function(){pulse.plugins.invoke(pulse.Scene.PLUGIN_TYPE,pulse.Scene.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onEnter,
this,arguments);for(var a=0;a<this._private.orderedKeys.length;a++){var b=this.layers[this._private.orderedKeys[a]];if(b.updated)pulse.renderer.clearLayer(b.name,this.sceneId),b.visible===true?b.draw():b.updated=false}pulse.plugins.invoke(pulse.Scene.PLUGIN_TYPE,pulse.Scene.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},on:function(a,b){this.events.bind(a,b)},eventsCallback:function(a,b){for(var e in this.layers)if(pulse.events[a]==="mouse"||pulse.events[a]==="touch"){var g=
this.layers[e].bounds;b.parent.x=b.position.x;b.parent.y=b.position.y;b.position.x=b.world.x-g.x;b.position.y=b.world.y-g.y;b.sender=this.layers[e];if(this.layers[e].pointInBounds(b.world)){if((a==="mousemove"||a==="touchmove")&&this.layers[e].mousein===false)this.layers[e].mousein=true,this.layers[e].events.raiseEvent("mouseover",b);this.layers[e].events.raiseEvent(a,b)}else if(this.layers[e].mousein===true)this.layers[e].mousein=false,this.layers[e].events.raiseEvent("mouseout",b)}else b.sender=
this.layers[e],this.layers[e].events.raiseEvent(a,b)}});pulse.Scene.PLUGIN_TYPE="pulse.Scene";pulse.Scene.PLUGIN_DRAW="draw";pulse.Scene.PLUGIN_UPDATE="update";pulse=pulse||{};
pulse.SceneManager=PClass.extend({init:function(a){a=pulse.util.checkParams(a,{gameWindow:document.getElementsByTagName("body")[0]});this.scenes={};this.parent=null;this.gameWindow=a.gameWindow},addScene:function(a){pulse.plugins.invoke("pulse.SceneManager","addScene",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);if(a instanceof pulse.Scene&&!this.scenes.hasOwnProperty(a.name)){a.parent=this.parent;var b=this.gameWindow.clientWidth,e=this.gameWindow.clientHeight;b===0&&this.gameWindow.style.width&&
(b=parseInt(this.gameWindow.style.width));e===0&&this.gameWindow.style.height&&(e=parseInt(this.gameWindow.style.height));a.setDefaultSize(b,e);this.scenes[a.name]=a}pulse.plugins.invoke("pulse.SceneManager","addScene",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},removeScene:function(a){pulse.plugins.invoke("pulse.SceneManager","removeScene",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);if(a instanceof pulse.Scene)a=a.name;this.scenes.hasOwnProperty(a)&&delete this.scenes[a];
pulse.plugins.invoke("pulse.SceneManager","removeScene",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},activateScene:function(a){if(a instanceof pulse.Scene)a=a.name;if(this.scenes.hasOwnProperty(a))this.scenes[a].active=true,this.gameWindow.appendChild(this.scenes[a].getSceneContainer())},deactivateScene:function(a){if(a instanceof pulse.Scene)a=a.name;if(this.scenes.hasOwnProperty(a)&&this.scenes[a].active)this.scenes[a].active=false,this.gameWindow.removeChild(this.scenes[a].getSceneContainer())},
getScene:function(a){return this.scenes[a]},getScenes:function(a){var b=[],e;for(e in this.scenes)a===true?this.scenes[e].active===true&&b.push(this.scenes[e]):b.push(this.scenes[e]);return b}});pulse=pulse||{};
pulse.Engine=PClass.extend({init:function(a){pulse.plugins.invoke("pulse.Engine","init",pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);a=pulse.util.checkParams(a,{gameWindow:"gameWindow",size:{width:0,height:0}});this.gameWindow=null;this.hidden=this.focused=false;this.gameWindow=typeof a.gameWindow==="object"?a.gameWindow:document.getElementById(a.gameWindow);this.size=a.size;if((this.size.width===0||this.size.width===void 0||this.size.height===0||this.size.height===void 0)&&this.gameWindow){var b=
parseInt(this.gameWindow.style.width,10),e=parseInt(this.gameWindow.style.height,10);if(b)this.size.width=b;if(e)this.size.height=e}if(this.size.width===0)this.size.width=640;if(this.size.height===0)this.size.height=480;this._private={};this._private.mainDiv=document.createElement("div");this._private.mainDiv.style.position="absolute";this._private.mainDiv.style.width=this.size.width+"px";this._private.mainDiv.style.height=this.size.height+"px";this._private.mainDiv.style.overflow="hidden";this._private.mainDiv.tabIndex=
1;this.gameWindow.appendChild(this._private.mainDiv);pulse.renderer=(new pulse.RendererInterface).implement(new pulse.PulseDefaultRenderer);this.scenes=new pulse.SceneManager({gameWindow:this._private.mainDiv});this.scenes.parent=this;this.masterTime=0;this.tick=100;this.loopLogic=null;this._private.currentTime=(new Date).getTime();this._private.lastTime=this._private.currentTime;pulse.plugins.invoke("pulse.Engine","init",pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},getWindowOffset:function(){var a=
this._private.mainDiv.offsetLeft,b=this._private.mainDiv.offsetTop;if(this._private.mainDiv.offsetParent){var e=this._private.mainDiv.offsetParent;do a+=e.offsetLeft,b+=e.offsetTop;while(e=e.offsetParent)}return{x:a,y:b}},bindEvents:function(){var a=this,b;for(b in pulse.events)window.addEventListener(b,function(b){a.windowEvent.call(a,b)},false),b==="mousewheel"&&window.addEventListener("DOMMouseScroll",function(b){a.windowEvent.call(a,b)},false)},go:function(a,b){this.tick=a;var e=this;this.bindEvents();
if(b)this.loopLogic=b;requestAnimFrame(function(){e.loop.call(e)},this._private.mainDiv)},loop:function(a){pulse.plugins.invoke(pulse.Engine.PLUGIN_TYPE,pulse.Engine.PLUGIN_LOOP,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);var b=this;(a||a===void 0)&&requestAnimFrame(function(){b.loop.call(b)},this._private.mainDiv);this._private.currentTime=(new Date).getTime();var e=this._private.currentTime-this._private.lastTime;if(!(e<this.tick)){var g=Math.floor(e/30);g===0&&(g=1);if(g<20){e/=g;
for(var f=0;f<g;f++)this.loopLogic&&this.loopLogic(this.scenes,e),this.update(e),this.draw(),this.masterTime+=e}this._private.lastTime=this._private.currentTime;pulse.plugins.invoke(pulse.Engine.PLUGIN_TYPE,pulse.Engine.PLUGIN_LOOP,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)}},update:function(a){pulse.plugins.invoke(pulse.Engine.PLUGIN_TYPE,pulse.Engine.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);for(var b=this.scenes.getScenes(true),e=0;e<b.length;e++)b[e].update(a);
pulse.plugins.invoke(pulse.Engine.PLUGIN_TYPE,pulse.Engine.PLUGIN_UPDATE,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},draw:function(){pulse.plugins.invoke(pulse.Engine.PLUGIN_TYPE,pulse.Engine.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onEnter,this,arguments);for(var a=this.scenes.getScenes(true),b=0;b<a.length;b++)a[b].draw();pulse.plugins.invoke(pulse.Engine.PLUGIN_TYPE,pulse.Engine.PLUGIN_DRAW,pulse.plugin.PluginCallbackTypes.onExit,this,arguments)},windowEvent:function(a){if(!this.hidden){if(!a)a=
window.event;var b=a.type,e=this.scenes.getScenes(true),g=this.getWindowOffset(),f=0,i=0;window.pageXOffset&&window.pageYOffset?(f=window.pageXOffset,i=window.pageYOffset):(f=document.body.scrollLeft,i=document.body.scrollTop);var h=new pulse.MouseEvent,d=a.clientX-g.x+f,k=a.clientY-g.y+i,o=false;if(pulse.events[b]==="touch"||pulse.events[b]==="touchgesture"){o=true;h=new pulse.TouchEvent;if(a.touches&&a.touches.length>0)d=a.touches[0].clientX-g.x+f,k=a.touches[0].clientY-g.y+i,h.touches=a.touches;
if(a.changedTouches&&a.changedTouches.length>0)h.changedTouches=a.changedTouches,b==="touchend"&&(d=a.changedTouches[0].clientX-g.x+f,k=a.changedTouches[0].clientY-g.y+i);if(a.targetTouches&&a.targetTouches.length>0)h.targetTouches=a.changedTouches;if(a.scale&&a.rotation)h.gestureScale=a.scale,h.gestureRotation=a.rotation;this.focused=true}h.window.x=a.clientX;h.window.y=a.clientY;h.world.x=d;h.world.y=k;g=false;d>0&&d<parseInt(this._private.mainDiv.style.width,10)&&k>0&&k<parseInt(this._private.mainDiv.style.height,
10)&&(g=true);for(f=0;f<e.length;f++){h.parent.x=h.window.x;h.parent.y=h.window.y;h.position.x=d;h.position.y=k;if(g){if(a.preventDefault&&o===false&&a.preventDefault(),document.activeElement!==this._private.mainDiv&&a.type.toLowerCase()==="click"&&(document.activeElement.blur(),this._private.mainDiv.focus()),a.type.toLowerCase()==="mousedown")this.focused=true}else{if(a.type.toLowerCase()==="mousedown")this.focused=false;e[f].events.raiseEvent("mouseout",h)}if(a.type.toLowerCase()==="mousewheel"||
a.type.toLowerCase()==="dommousescroll")b=0,a.wheelDelta?b=a.wheelDelta/120:a.detail&&(b=-a.detail/3),h.scrollDelta=b,b="mousewheel";if(pulse.events[a.type]==="keyboard"){var j;if(a.charCode)j=a.charCode;else if(a.keyCode)j=a.keyCode;else if(a.which)j=a.which;h.keyCode=j;h.key=String.fromCharCode(j)}if(this.focused)h.sender=e[f],e[f].events.raiseEvent(b,h)}if(a.type.toLowerCase()==="mouseup"&&!g)for(var B in pulse.EventManager.DraggedItems)B.indexOf("sprite")===0&&pulse.EventManager.DraggedItems[B].killDrag(h)}},
addScene:function(a){this.scenes&&this.scenes.addScene&&this.scenes.addScene(a)},removeScene:function(a){this.scenes&&this.scenes.addScene&&this.scenes.removeScene(a)},activateScene:function(a){this.scenes&&this.scenes.addScene&&this.scenes.activateScene(a)},deactivateScene:function(a){this.scenes&&this.scenes.addScene&&this.scenes.deactivateScene(a)}});pulse.Engine.PLUGIN_TYPE="pulse.Engine";pulse.Engine.PLUGIN_LOOP="loop";pulse.Engine.PLUGIN_UPDATE="update";pulse.Engine.PLUGIN_DRAW="draw";
